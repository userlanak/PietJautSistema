(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[7426],{7426:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return d}});var a=i(2122),n=i(7294),r=i(5637),s=i(5257),l=i(9151),c=i(2957),o=i(5893);function d(e){var t=e.formID,i=e.sheetConf,d=e.setSheetConf,f=e.step,m=e.setstep,u=e.isLoading,h=e.setisLoading,_=e.setSnackbar,b=e.redirectLocation,p=e.isInfo,g=(0,n.useState)(!1),v=g[0],w=g[1],I=(0,n.useState)({dataCenter:"",clientId:"",clientSecret:""}),x=I[0],C=I[1],S=function(e){var t=(0,a.Z)({},i),n=(0,a.Z)({},x);n[e.target.name]="",t[e.target.name]=e.target.value,C(n),d(t)};return(0,o.jsxs)("div",{className:"btcd-stp-page",style:(0,a.Z)({},{width:1===f&&900},{height:1===f&&"100%"}),children:[(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)("b",{children:(0,r.__)("Integration Name:","bitform")})}),(0,o.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:S,name:"name",value:i.name,type:"text",placeholder:(0,r.__)("Integration Name...","bitform"),disabled:p}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)("b",{children:(0,r.__)("Homepage URL:","bitform")})}),(0,o.jsx)(l.Z,{value:""+window.location.origin,setSnackbar:_,className:"field-key-cpy w-6 ml-0",readOnly:p}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)("b",{children:(0,r.__)("Authorized Redirect URIs:","bitform")})}),(0,o.jsx)(l.Z,{value:b||""+window.location.href,setSnackbar:_,className:"field-key-cpy w-6 ml-0",readOnly:p}),(0,o.jsxs)("small",{className:"d-blk mt-5",children:[(0,r.__)("To get Client ID and SECRET , Please Visit","bitform")," ",(0,o.jsx)("a",{className:"btcd-link",href:"https://us7.admin.mailchimp.com/account/oauth2/",target:"_blank",rel:"noreferrer",children:(0,r.__)("Mail Chimp API Console","bitform")})]}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)("b",{children:(0,r.__)("Client id:","bitform")})}),(0,o.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:S,name:"clientId",value:i.clientId,type:"text",placeholder:(0,r.__)("Client id...","bitform"),disabled:p}),(0,o.jsx)("div",{style:{color:"red",fontSize:"15px"},children:x.clientId}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)("b",{children:(0,r.__)("Client secret:","bitform")})}),(0,o.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:S,name:"clientSecret",value:i.clientSecret,type:"text",placeholder:(0,r.__)("Client secret...","bitform"),disabled:p}),(0,o.jsx)("div",{style:{color:"red",fontSize:"15px"},children:x.clientSecret}),!p&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{onClick:function(){return(0,c.Lx)("mailChimp","mChimp",i,d,C,w,h,_)},className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:v,children:[v?(0,r.__)("Authorized ✔","bitform"):(0,r.__)("Authorize","bitform"),u&&(0,o.jsx)(s.Z,{size:"20",clr:"#022217",className:"ml-2"})]}),(0,o.jsx)("br",{}),(0,o.jsxs)("button",{onClick:function(){m(2),(0,c.qC)(t,i,d,h,_),document.querySelector(".btcd-s-wrp").scrollTop=0},className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",disabled:!v,children:[(0,r.__)("Next","bitform")," "," ",(0,o.jsx)("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]})]})}},2957:function(e,t,i){"use strict";i.d(t,{Rx:function(){return l},a7:function(){return c},qC:function(){return d},TF:function(){return f},WK:function(){return u},Lx:function(){return h}});var a=i(2122),n=i(9492),r=i(2249),s=i(5637),l=function(e,t,i,n,r,s,l,c,d){var f=(0,a.Z)({},t);if(l){var m=(0,a.Z)({},c);m[e.target.name]="",d((0,a.Z)({},m))}switch(f[e.target.name]=e.target.value,e.target.name){case"listId":f=o(f,n,i,r,s)}i((0,a.Z)({},f))},c=function(e){return!((null!=e&&e.address_field?e.address_field.filter((function(e){return!e.formField&&e.mailChimpAddressField&&e.required})):[]).length>0)},o=function(e,t,i,a,n){var s,l,c=(0,r.p$)(e);return c.field_map=[{formField:"",mailChimpField:""}],null!=c&&null!=(s=c.default)&&null!=(l=s.fields)&&l[e.listId]||(f(t,c,i,a,n),m(t,c,i,a,n)),c},d=function(e,t,i,r,l){r(!0);var c={formID:e,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,n.Z)(c,"bitforms_mChimp_refresh_audience").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);n.default||(n.default={}),e.data.audiencelist&&(n.default.audiencelist=e.data.audiencelist),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,s.__)("Audience list refreshed","bitform")}),i((0,a.Z)({},n))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:(0,s.g)((0,s.__)("Audience list refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):l({show:!0,msg:(0,s.__)("Audience list failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},f=function(e,t,i,r,l){r(!0);var c={formID:e,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,listId:t.listId};(0,n.Z)(c,"bitforms_mChimp_refresh_tags").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);e.data.audienceTags&&(n.default.audienceTags=e.data.audienceTags),l({show:!0,msg:(0,s.__)("Audience tags refreshed","bitform")}),i((0,a.Z)({},n))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:(0,s.g)((0,s.__)("Audience tags refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):l({show:!0,msg:(0,s.__)("Audience tags failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))},m=function(e,t,i,r,l){var c=t.listId;if(c){r(!0);var o={formID:e,listId:c,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,n.Z)(o,"bitforms_mChimp_refresh_fields").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);e.data.audienceField&&(n.default.fields||(n.default.fields={}),n.default.fields[c]=e.data.audienceField),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,s.__)("Fields refreshed","bitform")}),i((0,a.Z)({},n))}else l({show:!0,msg:(0,s.__)("Fields refresh failed. please try again","bitform")});r(!1)})).catch((function(){return r(!1)}))}},u=function(e){var t={},i=window.location.href.replace(""+window.opener.location.href,"").split("&");i&&i.forEach((function(e){var i=e.split("=");i[1]&&(t[i[0]]=i[1])})),localStorage.setItem("__bitforms_"+e,JSON.stringify(t)),window.close()},h=function(e,t,i,n,r,l,c,o){if(i.clientId&&i.clientSecret){c(!0);var d="https://login.mailchimp.com/oauth2/authorize?client_id="+i.clientId+"&redirect_uri="+encodeURIComponent(window.location.href)+"&response_type=code",f=window.open(d,e,"width=400,height=609,toolbar=off"),m=setInterval((function(){if(f.closed){clearInterval(m);var r={},d=!1,u=localStorage.getItem("__bitforms_"+e);if(u&&(d=!0,r=JSON.parse(u),localStorage.removeItem("__bitforms_"+e),r.code.search("#"))){var h=r.code.split("#");r.code=h[0]}if(r.code&&!r.error&&r&&d){var b=(0,a.Z)({},i);b.accountServer=r["accounts-server"],_(t,r,b,n,l,c,o)}else{var p=r.error?"Cause: "+r.error:"";o({show:!0,msg:(0,s.__)("Authorization failed","bitform")+" "+p+". "+(0,s.__)("please try again","bitform")}),c(!1)}}}),500)}else r({clientId:i.clientId?"":(0,s.__)("Client ID cann't be empty","bitform"),clientSecret:i.clientSecret?"":(0,s.__)("Secret key cann't be empty","bitform")})},_=function(e,t,i,r,l,c,o){var d=(0,a.Z)({},t);d.clientId=i.clientId,d.clientSecret=i.clientSecret,d.redirectURI=window.location.href,(0,n.Z)(d,"bitforms_"+e+"_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var t=(0,a.Z)({},i);t.tokenDetails=e.data,r(t),l(!0),o({show:!0,msg:(0,s.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,s.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}):o({show:!0,msg:(0,s.__)("Authorization failed. please try again","bitform")});c(!1)}))}}}]);