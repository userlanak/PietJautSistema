(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[5414],{5414:function(t,e,a){"use strict";a.d(e,{Yd:function(){return n},Rx:function(){return i},c0:function(){return c},Ir:function(){return f},WP:function(){return m},AA:function(){return p},D6:function(){return h},GX:function(){return _},n:function(){return k},mM:function(){return g},FT:function(){return I},TF:function(){return b},zF:function(){return j},P_:function(){return D}});var s=a(2122),r=a(5637),o=a(9492),l=function(t,e){var a=(0,s.Z)({},t),r=["projectId","milestoneId","tasklistFlag","tasklistId","taskId"];return r.splice(r.indexOf(e)+1).map((function(t){null!=a&&a[t]&&(a[t]=""),a.actions[t.split("Id")[0]]={}})),(0,s.Z)({},a)},n=function(t,e,a,r,o){var l=(0,s.Z)({},e);return l.subEvent.map((function(e){var s,n,i,d,u,c,f;(null==l||!l.projectId||null!=l&&null!=(s=l.default)&&null!=(n=s.fields)&&null!=(i=n[l.portalId])&&null!=(d=i[l.projectId])&&d[e])&&null!=l&&null!=(u=l.default)&&null!=(c=u.fields)&&null!=(f=c[l.portalId])&&f[e]?l.field_map[e]=v(l,e):_(t,l,a,r,o,e)})),(0,s.Z)({},l)},i=function(t,e,a,r,o,i,c,f,_){var k,g,I,b=(0,s.Z)({},e),v=t.target.name,j=t.target.value;if(c){var D=(0,s.Z)({},f);D[v]="",_((0,s.Z)({},D))}switch(b[v]=j,v){case"portalId":b=d(b,r,a,o,i);break;case"event":b.subEvent=[j],b.field_map={},b.actions[j]={},b=u(l(b),r,a,o,i);break;case"projectId":case"milestoneId":case"tasklistId":case"taskId":var w,Z;b=l(b,v);var y=v.split("Id")[0];b.actions[y]={},b.actions[b.event]={},b.subEvent.includes(y)&&b.subEvent.splice(b.subEvent.indexOf(y),1),["project","milestone"].includes(b.event)||"project"!==y||null!=e&&null!=(w=e.default)&&null!=(Z=w.milestones)&&Z[b.portalId]||m(r,b,a,o,i),"subtask"===b.event&&"task"!==y&&h(r,b,a,o,i),b=n(r,b,a,o,i);break;case"tasklistFlag":b.tasklistId="",j&&b.subEvent.includes("tasklist")&&b.subEvent.splice(b.subEvent.indexOf("tasklist"),1),!j||!["task","subtask"].includes(b.event)||null!=e&&null!=(k=e.default)&&null!=(g=k.milestones)&&null!=(I=g[b.portalId])&&I[j]||p(r,b,a,o,i)}a((0,s.Z)({},b))},d=function(t,e,a,r,o){var l,n,i=(0,s.Z)({},t);return i.event="",i.field_map={},i.actions={},i.subEvent=[],null==t||!t.portalId||null!=(l=t.default.tags)&&l[i.portalId]||b(e,t,a,r,o),null==t||!t.portalId||null!=(n=t.default.projects)&&n[i.portalId]||f(e,i,a,r,o),i},u=function(t,e,a,r,o){var l,n,i,d=(0,s.Z)({},t);(d.field_map={},d.field_map[d.event]=[{formField:"",zohoFormField:""}],null!=d&&d.event)&&(null!=d&&null!=(l=d.default)&&null!=(n=l.fields)&&null!=(i=n[d.portalId])&&i[d.event]?d.field_map[d.event]=v(d):_(e,d,a,r,o));return d},c=function(t,e,a,l,n){l(!0);var i={formID:t,id:e.id,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};(0,o.Z)(i,"bitforms_zprojects_refresh_portals").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);t.data.portals&&(Object.keys(t.data.portals).length>0?(o.default=(0,s.Z)({},o.default,{portals:t.data.portals}),n({show:!0,msg:(0,r.__)("Portals refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Portal Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),n({show:!0,msg:(0,r.__)("Portals refreshed","bitform")}),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Portals refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Portals refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},f=function(t,e,a,l,n){var i=e.id,d=e.portalId;l(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,o.Z)(u,"bitforms_zprojects_refresh_projects").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);o.default.projects||(o.default.projects={}),t.data.projects&&(Object.keys(t.data.projects).length>0?(o.default.projects[d]=t.data.projects,n({show:!0,msg:(0,r.__)("Projects refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Project Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Projects refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Projects refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},m=function(t,e,a,l,n){var i=e.id,d=e.portalId,u=e.projectId;l(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d,projectId:u};(0,o.Z)(c,"bitforms_zprojects_refresh_milestones").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);t.data.milestones&&(o.default.milestones||(o.default.milestones={}),Object.keys(t.data.milestones).length>0?(o.default.milestones[u]=t.data.milestones,n({show:!0,msg:(0,r.__)("Milestones refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Milestone Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Milestones refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Milestones refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},p=function(t,e,a,l,n){var i=e.id,d=e.portalId,u=e.projectId,c=e.tasklistFlag;l(!0);var f={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d,projectId:u,tasklistFlag:c};null!=e&&e.milestoneId&&(f.milestoneId=e.milestoneId),(0,o.Z)(f,"bitforms_zprojects_refresh_tasklists").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);Object.keys(t.data.tasklists).length>0?(o.default.tasklists||(o.default.tasklists={}),o.default.tasklists[d]||(o.default.tasklists[d]={}),null!=e&&e.milestoneId?(o.default.tasklists[d][e.milestoneId]||(o.default.tasklists[d][e.milestoneId]={}),o.default.tasklists[d][e.milestoneId][c]=t.data.tasklists):o.default.tasklists[d][c]=t.data.tasklists,n({show:!0,msg:(0,r.__)("Tasklists refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Tasklist Found","bitform")}),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Tasklists refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Tasklists refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},h=function(t,e,a,l,n){var i=e.id,d=e.portalId,u=e.projectId;l(!0);var c={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d,projectId:u};null!=e&&e.milestoneId&&(c.milestoneId=e.milestoneId),null!=e&&e.tasklistId&&(c.tasklistId=e.tasklistId),(0,o.Z)(c,"bitforms_zprojects_refresh_tasks").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);Object.keys(t.data.tasks).length>0?(o.default.tasks||(o.default.tasks={}),o.default.tasks[d]||(o.default.tasks[d]={}),null!=e&&e.milestoneId?null!=e&&e.tasklistId?(o.default.tasks[d][null==e?void 0:e.milestoneId]||(o.default.tasks[d][null==e?void 0:e.milestoneId]={}),o.default.tasks[d][null==e?void 0:e.milestoneId][null==e?void 0:e.tasklistId]=t.data.tasks):o.default.tasks[d][null==e?void 0:e.milestoneId]=t.data.tasks:null!=e&&e.tasklistId?o.default.tasks[d][null==e?void 0:e.tasklistId]=t.data.tasks:o.default.tasks[d]=t.data.tasks,n({show:!0,msg:(0,r.__)("Tasks refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Task Found","bitform")}),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Tasks refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Tasks refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},_=function(t,e,a,l,n,i){var d;d=i||e.event;var u=e.portalId;l(!0);var c={formID:t,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:u,event:d};null!=e&&e.projectId&&(c.projectId=e.projectId),(0,o.Z)(c,"bitforms_zprojects_refresh_fields").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);t.data.fields?(o.default.fields||(o.default.fields={}),o.default.fields[u]||(o.default.fields[u]={}),null!=e&&e.projectId?(o.default.fields[u][e.projectId]||(o.default.fields[u][e.projectId]={}),o.default.fields[u][o.projectId][d]=(0,s.Z)({},t.data)):o.default.fields[u][d]=(0,s.Z)({},t.data),o.field_map[d]=v(o,d),n({show:!0,msg:(0,r.__)("Fields refreshed","bitform")})):n({show:!0,msg:(0,r.g)((0,r.__)("Fields refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else n({show:!0,msg:(0,r.__)("Fields refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},k=function(t,e,a,l,n){var i=e.id,d=e.portalId;l(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:e.portalId};null!=e&&e.projectId&&(u.projectId=e.projectId),(0,o.Z)(u,"bitforms_zprojects_refresh_users").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);o.default.users||(o.default.users={}),t.data.users&&(Object.keys(t.data.users).length>0?(null!=e&&e.projectId?(o.default.users[d]||(o.default.users[d]={}),o.default.users[d][e.projectId]=t.data.users):o.default.users[d]=t.data.users,n({show:!0,msg:(0,r.__)("Owners refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Owner Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Owners refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Owners refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},g=function(t,e,a,l,n){var i=e.id,d=e.portalId;l(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,o.Z)(u,"bitforms_zprojects_refresh_task_layouts").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);o.default.taskLays||(o.default.taskLays={}),t.data.taskLays&&(Object.keys(t.data.taskLays).length>0?(o.default.taskLays[d]=t.data.taskLays,n({show:!0,msg:(0,r.__)("Task Layouts refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Task Layout Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Task Layouts refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Task Layouts refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},I=function(t,e,a,l,n){var i=e.id,d=e.portalId;l(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,o.Z)(u,"bitforms_zprojects_refresh_groups").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);o.default.groups||(o.default.groups={}),t.data.groups&&(Object.keys(t.data.groups).length>0?(o.default.groups[d]=t.data.groups,n({show:!0,msg:(0,r.__)("Project Groups refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Project Group Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Project Groups refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Project Groups refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},b=function(t,e,a,l,n){var i=e.id,d=e.portalId;l(!0);var u={formID:t,id:i,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,portalId:d};(0,o.Z)(u,"bitforms_zprojects_refresh_tags").then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);o.default.tags||(o.default.tags={}),t.data.tags&&(Object.keys(t.data.tags).length>0?(o.default.tags[d]=t.data.tags,n({show:!0,msg:(0,r.__)("Tags refreshed","bitform")})):n({show:!0,msg:(0,r.__)("No Tag Found","bitform")})),t.data.tokenDetails&&(o.tokenDetails=t.data.tokenDetails),a((0,s.Z)({},o))}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?n({show:!0,msg:(0,r.g)((0,r.__)("Tags refresh failed Cause: %s. please try again","bitform"),t.data.data||t.data)}):n({show:!0,msg:(0,r.__)("Tags refresh failed. please try again","bitform")});l(!1)})).catch((function(){return l(!1)}))},v=function(t,e){var a,s,r;return s=e||t.event,null!=t&&t.projectId?t.default.fields[t.portalId][t.projectId][s].required.length>0?null==(r=t.default.fields[t.portalId][t.projectId][s].required)?void 0:r.map((function(t){return{formField:"",zohoFormField:t}})):[{formField:"",zohoFormField:""}]:t.default.fields[t.portalId][s].required.length>0?null==(a=t.default.fields[t.portalId][s].required)?void 0:a.map((function(t){return{formField:"",zohoFormField:t}})):[{formField:"",zohoFormField:""}]},j=function(t,e){return function(t){var e=!0;return null!=t&&t.subEvent&&t.subEvent.map((function(a){var s,r;(null!=t&&t.projectId?null!=t&&null!=(s=t.field_map)&&s[a]?t.field_map[a].filter((function(e){var s,r,o,l,n;return!e.formField&&e.zohoFormField&&-1!==(null==t||null==(s=t.default)||null==(r=s.fields)||null==(o=r[t.portalId])||null==(l=o[t.projectId])||null==(n=l[a])?void 0:n.required.indexOf(e.zohoFormField))})):[]:null!=t&&null!=(r=t.field_map)&&r[a]?t.field_map[a].filter((function(e){var s,r,o,l;return!e.formField&&e.zohoFormField&&-1!==(null==t||null==(s=t.default)||null==(r=s.fields)||null==(o=r[t.portalId])||null==(l=o[a])?void 0:l.required.indexOf(e.zohoFormField))})):[]).length>0&&(e=!1)})),!!e}(t)?function(t){var e=!0,a={project:["owner","tasklayoutid"],milestone:["owner","flag"],tasklist:["flag"],task:["owner"],subtask:["owner"],issue:["owner","flag"]};return null!=t&&t.subEvent&&t.subEvent.map((function(s){a[s].map((function(a){t.actions[s][a]||(e=!1)}))})),!!e}(t)?"subtask"!==(null==t?void 0:t.event)||null!=t&&t.taskId||t.subEvent.includes("task")?!(["task","subtask"].includes(null==t?void 0:t.event)&&(null!=t&&t.milestoneId||t.subEvent.includes("milestone"))&&!(null!=t&&t.tasklistId||t.subEvent.includes("tasklist")))||(e({show:!0,msg:(0,r.g)((0,r.__)("to create a %s under milestone you must select a tasklist or create a new tasklist","bitform"),t.event)}),!1):(e({show:!0,msg:(0,r.__)("to create a subtask you must select a task or create a new task","bitform")}),!1):(e({show:!0,msg:(0,r.__)("please fill up the required actions","bitform")}),!1):(e({show:!0,msg:(0,r.__)("please map mandatory fields","bitform")}),!1)},D=function(t,e,a,o,l,n){if(t.dataCenter&&t.clientId&&t.clientSecret){l(!0);var i="https://accounts.zoho."+t.dataCenter+"/oauth/v2/auth?scope=ZohoProjects.portals.READ,ZohoProjects.projects.READ,ZohoProjects.projects.CREATE,ZohoProjects.projects.UPDATE,ZohoProjects.milestones.READ,ZohoProjects.milestones.CREATE,ZohoProjects.milestones.UPDATE,ZohoProjects.tasklists.READ,ZohoProjects.tasklists.CREATE,ZohoProjects.tasklists.UPDATE,ZohoProjects.tasks.READ,ZohoProjects.tasks.CREATE,ZohoProjects.tasks.UPDATE,ZohoProjects.bugs.READ,ZohoProjects.bugs.CREATE,ZohoProjects.bugs.UPDATE,ZohoProjects.tags.ALL,ZohoProjects.users.READ,ZohoProjects.users.CREATE,ZohoProjects.timesheets.CREATE,ZohoPC.files.ALL&response_type=code&client_id="+t.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",d=window.open(i,"zohoProjects","width=400,height=609,toolbar=off"),u=setInterval((function(){if(d.closed){clearInterval(u);var a={},i=!1,c=localStorage.getItem("__bitforms_zohoProjects");if(c&&(i=!0,a=JSON.parse(c),localStorage.removeItem("__bitforms_zohoProjects")),a.code&&!a.error&&a&&i){var f=(0,s.Z)({},t);f.accountServer=a["accounts-server"],w(a,f,e,o,l,n)}else{var m=a.error?"Cause: "+a.error:"";n({show:!0,msg:(0,r.__)("Authorization failed","bitform")+" "+m+". "+(0,r.__)("please try again","bitform")}),l(!1)}}}),500)}else a({dataCenter:t.dataCenter?"":(0,r.__)("Data center cann't be empty","bitform"),clientId:t.clientId?"":(0,r.__)("Client ID cann't be empty","bitform"),clientSecret:t.clientSecret?"":(0,r.__)("Secret key cann't be empty","bitform")})},w=function(t,e,a,l,n,i){var d=(0,s.Z)({},t);d.dataCenter=e.dataCenter,d.clientId=e.clientId,d.clientSecret=e.clientSecret,d.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,o.Z)(d,"bitforms_zprojects_generate_token").then((function(t){return t})).then((function(t){if(t&&t.success){var o=(0,s.Z)({},e);o.tokenDetails=t.data,a(o),l(!0),i({show:!0,msg:(0,r.__)("Authorized Successfully","bitform")})}else t&&t.data&&t.data.data||!t.success&&"string"===typeof t.data?i({show:!0,msg:""+(0,r.__)("Authorization failed Cause:","bitform")+(t.data.data||t.data)+". "+(0,r.__)("please try again","bitform")}):i({show:!0,msg:(0,r.__)("Authorization failed. please try again","bitform")});n(!1)}))}}}]);