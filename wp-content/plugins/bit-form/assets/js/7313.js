(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[7313],{5813:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(5637),r=a(5893);function l(e){var t=e.step,a=e.saveConfig,l=e.edit,n=e.disabled;return l?(0,r.jsx)("div",{className:"txt-center w-9 mt-3",children:(0,r.jsx)("button",{onClick:a,className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:n,children:(0,s.__)("Save","bitform")})}):(0,r.jsxs)("div",{className:"btcd-stp-page txt-center",style:{width:3===t&&"90%",height:3===t&&"100%"},children:[(0,r.jsx)("h2",{className:"ml-3",children:(0,s.__)("Successfully Integrated","bitform")}),(0,r.jsxs)("button",{onClick:a,className:"btn btcd-btn-lg green sh-sm",type:"button",children:[(0,s.__)("Finish & Save ","bitform"),"âœ”"]})]})}},1276:function(e,t,a){"use strict";a.d(t,{Rx:function(){return i},V9:function(){return d},B5:function(){return f},ud:function(){return u},n:function(){return m},P_:function(){return h}});var s=a(2122),r=a(5637),l=a(9492),n=a(2249),i=function(e,t,a,r,l,n,i,d,f,u){var m=(0,s.Z)({},t);if(d){var h=(0,s.Z)({},f);h[e.target.name]="",u((0,s.Z)({},h))}switch(m[e.target.name]=e.target.value,e.target.name){case"team":m=o(m,r,a,l,n);break;case"folder":m.folderMap=m.folderMap.slice(0,i),m=c(m,r,a,l,n)}a((0,s.Z)({},m))},o=function(e,t,a,r,l){var n,i,o=(0,s.Z)({},e);return o.folder="",!o.team||null!=o&&null!=(n=o.default)&&null!=(i=n.teamFolders)&&i[o.team]||f(t,o,a,r,l),o},c=function(e,t,a,r,l){var n,i,o,c,d,f,m=(0,s.Z)({},e);(delete m.teamType,!m.folder||null!=(n=m.default)&&null!=(i=n.folders)&&i[m.folder])?m.folder&&m.folder!==m.folderMap[m.folderMap.length-1]&&m.folderMap.push(m.folder):("private"===(null==(o=m.default)||null==(c=o.teamFolders)||null==(d=c[m.team])||null==(f=d[m.folder])?void 0:f.type)&&(m.teamType="private"),u(t,m,a,r,l));return m},d=function(e,t,a,n,i){n(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,l.Z)(o,"bitforms_zworkdrive_refresh_teams").then((function(e){if(e&&e.success){var l=(0,s.Z)({},t);e.data.teams&&(l.default=(0,s.Z)({},l.default,{teams:e.data.teams})),e.data.tokenDetails&&(l.tokenDetails=e.data.tokenDetails),i({show:!0,msg:(0,r.__)("Teams refreshed","bitform")}),a((0,s.Z)({},l))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?i({show:!0,msg:(0,r.g)((0,r.__)("Teams refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):i({show:!0,msg:(0,r.__)("Teams refresh failed. please try again","bitform")});n(!1)})).catch((function(){return n(!1)}))},f=function(e,t,a,n,i){n(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,team:t.team};(0,l.Z)(o,"bitforms_zworkdrive_refresh_team_folders").then((function(e){if(e&&e.success){var l=(0,s.Z)({},t);l.default.teamFolders||(l.default.teamFolders={}),e.data.teamFolders&&(l.default.teamFolders[l.team]=e.data.teamFolders),e.data.tokenDetails&&(l.tokenDetails=e.data.tokenDetails),i({show:!0,msg:(0,r.__)("Folders refreshed","bitform")}),a((0,s.Z)({},l))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?i({show:!0,msg:(0,r.g)((0,r.__)("Folders refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):i({show:!0,msg:(0,r.__)("Folders refresh failed. please try again","bitform")});n(!1)})).catch((function(){return n(!1)}))},u=function(e,t,a,i,o,c){var d=c?t.folderMap[c]:t.folder;i(!0);var f={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,team:t.team,folder:d,teamType:"teamType"in t?"private":"team"};(0,l.Z)(f,"bitforms_zworkdrive_refresh_sub_folders").then((function(e){if(e&&e.success){var l=(0,s.Z)({},t);e.data.folders?(l.default.folders||(l.default.folders={}),l.default.folders[d]=(0,n.SI)(e.data.folders,"folderName"),l.folderMap.includes(d)||l.folderMap.push(d),o({show:!0,msg:(0,r.__)("Sub Folders refreshed","bitform")})):o({show:!0,msg:(0,r.__)("No Sub Folder Found","bitform")}),e.data.tokenDetails&&(l.tokenDetails=e.data.tokenDetails),a((0,s.Z)({},l))}else o({show:!0,msg:(0,r.__)("Sub Folders refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},m=function(e,t,a,n,i){n(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,team:t.team};(0,l.Z)(o,"bitforms_zworkdrive_refresh_users").then((function(e){if(e&&e.success){var l=(0,s.Z)({},t);l.default.users||(l.default.users={}),e.data.users&&(l.default.users[t.team]=e.data.users),e.data.tokenDetails&&(l.tokenDetails=e.data.tokenDetails),i({show:!0,msg:(0,r.__)("Users refreshed","bitform")}),a((0,s.Z)({},l))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?i({show:!0,msg:(0,r.g)((0,r.__)("Users refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):i({show:!0,msg:(0,r.__)("Users refresh failed. please try again","bitform")});n(!1)})).catch((function(){return n(!1)}))},h=function(e,t,a,l,n,i){if(e.dataCenter&&e.clientId&&e.clientSecret){n(!0);var o="https://accounts.zoho."+e.dataCenter+"/oauth/v2/auth?scope=WorkDrive.team.READ,WorkDrive.workspace.READ,WorkDrive.workspace.CREATE,WorkDrive.workspace.UPDATE,WorkDrive.files.READ,WorkDrive.files.CREATE&response_type=code&client_id="+e.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",c=window.open(o,"zohoWorkDrive","width=400,height=609,toolbar=off"),d=setInterval((function(){if(c.closed){clearInterval(d);var a={},o=!1,f=localStorage.getItem("__bitforms_zohoWorkDrive");if(f&&(o=!0,a=JSON.parse(f),localStorage.removeItem("__bitforms_zohoWorkDrive")),a.code&&!a.error&&a&&o){var u=(0,s.Z)({},e);u.accountServer=a["accounts-server"],p(a,u,t,l,n,i)}else{var m=a.error?"Cause: "+a.error:"";i({show:!0,msg:(0,r.__)("Authorization failed","bitform")+" "+m+". "+(0,r.__)("please try again","bitform")}),n(!1)}}}),500)}else a({dataCenter:e.dataCenter?"":(0,r.__)("Data center cann't be empty","bitform"),clientId:e.clientId?"":(0,r.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,r.__)("Secret key cann't be empty","bitform")})},p=function(e,t,a,n,i,o){var c=(0,s.Z)({},e);c.dataCenter=t.dataCenter,c.clientId=t.clientId,c.clientSecret=t.clientSecret,c.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,l.Z)(c,"bitforms_zworkdrive_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var l=(0,s.Z)({},t);l.tokenDetails=e.data,a(l),n(!0),o({show:!0,msg:(0,r.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,r.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):o({show:!0,msg:(0,r.__)("Authorization failed. please try again","bitform")});i(!1)}))}},1686:function(e,t,a){"use strict";a.d(t,{Z:function(){return h}});var s=a(5637),r=a(8381),l=a(2122),n=a(7294),i=a(7707),o=a(3921),c=a(8762),d=a(8281),f=a(1276),u=a(5893);function m(e){var t,a,m,h,p,b,v,_,x,g,j,w,k,y,N,C,D,Z,S,F,I,T,R,A,M,L,W,z,U=e.workDriveConf,E=e.setWorkDriveConf,V=e.formFields,O=e.formID,B=e.setSnackbar,P=U.folderMap?U.folderMap[0]:U.folder,$=(0,n.useState)(!1),q=$[0],J=$[1],K=(0,n.useState)({show:!1}),G=K[0],H=K[1],Q=(0,n.useState)([]),X=Q[0],Y=Q[1],ee=function(e,t,a){var s=(0,l.Z)({},U);"create_folder"===t?e.target.checked?s.actions.create_folder={name:"",suffix:!1}:(delete s.actions.create_folder,delete s.actions.share.folder):"attachments"===t?""!==e?s.actions.attachments=e:(delete s.actions.attachments,delete s.actions.share.file):"mail"===t&&(s.actions.share||(s.actions.share={}),"folder"===a?e.target.checked?s.actions.share.folder.mail="true":s.actions.share.folder.mail="false":"file"===a&&(e.target.checked?s.actions.share.file.mail="true":s.actions.share.file.mail="false")),E((0,l.Z)({},s))},te=function(e,t,a,s){var r=(0,l.Z)({},U);r.actions.share[s].permissions[e][t]=a,E((0,l.Z)({},r))},ae=function(e,t,a){var s=(0,l.Z)({},U);"name"===t?a?s.actions.create_folder.name+=e.target.value:s.actions.create_folder.name=e.target.value:e.target.checked?s.actions.create_folder.suffix=!0:s.actions.create_folder.suffix=!1,E((0,l.Z)({},s))},se=function(){H({show:!1})};return(0,n.useEffect)((function(){var e,t,a,s,r=[{title:"Zoho Workdrive Users",type:"group",childs:[]},{title:"Form Fields",type:"group",childs:[]}];if(!U.team||null!=(e=U.default)&&null!=(t=e.users)&&t[U.team]||(0,f.n)(O,U,E,J,B),null!=(a=U.default)&&null!=(s=a.users)&&s[U.team]){r[0].childs[0]={label:"All Users",value:"all_users"};for(var l=Object.values(U.default.users[U.team]),n=0;n<l.length;n+=1)r[0].childs[n+1]={label:l[n].userName,value:l[n].userId}}r[1].childs=V.map((function(e){return{label:e.name,value:"${"+e.key+"}"}})),Y(r)}),[U.team,null==(t=U.default)||null==(a=t.users)?void 0:a[U.team]]),(0,u.jsxs)("div",{className:"pos-rel",children:[(0,u.jsxs)("div",{className:"d-flx flx-wrp",children:[(0,u.jsx)(d.Z,{action:function(){var e,t,a,s;null!=(e=U.actions)&&e.create_folder||(U.actions.create_folder={name:"",suffix:!1}),null!=(t=U.actions)&&t.share||(U.actions.share={}),null!=(a=U.actions)&&null!=(s=a.share)&&s.folder||(U.actions.share.folder={permissions:[{email:"",access:"34",accessLabel:"View"},{email:"",access:"5",accessLabel:"Edit"},{email:"",access:"3",accessLabel:"Organize"},{email:"",access:"7",accessLabel:"Upload"}],mail:"false"}),H({show:"create_folder"})},children:(0,u.jsx)(o.Z,{onChange:function(e){return ee(e,"create_folder")},checked:"create_folder"in(null==U?void 0:U.actions),className:"wdt-200 mt-4 mr-2",value:"Create_Folder",title:(0,s.__)("Create New Folder","bitform"),subTitle:(0,s.__)("Create a new folder in the selected folder","bitform")})}),(0,u.jsx)(o.Z,{onChange:function(){var e,t,a;null!=(e=U.actions)&&e.share||(U.actions.share={}),null!=(t=U.actions)&&null!=(a=t.share)&&a.file||(U.actions.share.file={permissions:[{email:"",access:"34",accessLabel:"View"},{email:"",access:"5",accessLabel:"Edit"},{email:"",access:"4",accessLabel:"Share"},{email:"",access:"6",accessLabel:"View and Comment"}],mail:"false"}),H({show:"attachments"})},checked:"attachments"in U.actions,className:"wdt-200 mt-4 mr-2",value:"Attachment",title:(0,s.__)("Upload Files","bitform"),subTitle:(0,s.__)("Add attachments from BitForm to Zoho Workdrive folder.","bitform")})]}),(0,u.jsx)(c.Z,{md:!0,show:"create_folder"===G.show,setModal:se,title:(0,s.__)("Create New Folder","bitform"),children:(0,u.jsxs)("div",{className:"o-a",style:{height:"95%"},children:[(0,u.jsx)("div",{className:"btcd-hr mt-2"}),(0,u.jsx)("div",{className:"mt-2",children:(0,s.__)("Add field value to use as folder name","bitform")}),(0,u.jsxs)("select",{value:"",className:"btcd-paper-inp mt-2 w-5",onChange:function(e){return ae(e,"name",1)},children:[(0,u.jsx)("option",{value:"",children:(0,s.__)("Select Field","bitform")}),null!==V&&V.map((function(e){return!e.type.match(/^(file-up|recaptcha)$/)&&(0,u.jsx)("option",{value:"${"+e.key+"}",children:e.name},e.key)}))]}),(0,u.jsx)("input",{type:"text",className:"btcd-paper-inp mt-2 w-9",value:null==(m=U.actions)||null==(h=m.create_folder)?void 0:h.name,onChange:function(e){return ae(e,"name")},placeholder:"New Folder Name"}),(0,u.jsx)(o.Z,{onChange:function(e){return ae(e,"suffix")},checked:null==U||null==(p=U.actions)||null==(b=p.create_folder)?void 0:b.suffix,className:"wd-100 mt-4 mr-2",value:"Add_Suffix",title:(0,s.__)("Add Random Number","bitform"),subTitle:"Zoho doesn't support duplicate folder name, if you want to make it uniquely you can add random number after the folder name."}),"private"===(null==(v=U.default)||null==(_=v.teamFolders)||null==(x=_[U.team])||null==(g=x[P])?void 0:g.type)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"btcd-hr mt-2"}),(0,u.jsxs)("div",{className:"flx mt-2",children:[(0,u.jsx)("div",{children:(0,s.__)("Share with users: (optional)","bitform")}),(0,u.jsx)("button",{onClick:function(){return(0,f.n)(O,U,E,J,B)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Team Users"'},type:"button",disabled:q,children:"â†»"})]}),q&&(0,u.jsx)(r.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}),null==(j=U.actions)||null==(w=j.share)||null==(k=w.folder)||null==(y=k.permissions)?void 0:y.map((function(e,t){return(0,u.jsxs)("div",{className:"flx flx-between mt-2",children:[(0,u.jsx)(i.Z,{defaultValue:e.email,className:"btcd-paper-drpdwn w-8 mr-2",onChange:function(e){return te(t,"email",e,"folder")},options:X}),(0,u.jsx)("input",{type:"text",value:e.accessLabel,className:"btcd-paper-inp w-2",readOnly:!0})]},e.accessLabel)})),(0,u.jsx)(o.Z,{onChange:function(e){return ee(e,"mail","folder")},checked:"true"===(null==U||null==(N=U.actions)||null==(C=N.share)||null==(D=C.folder)?void 0:D.mail)||!1,className:"wd-100 mt-4 mr-2",value:"true",title:(0,s.__)("Send Notification Mail","bitform")})]})]})}),(0,u.jsx)(c.Z,{md:!0,show:"attachments"===G.show,setModal:se,title:(0,s.__)("Select Attachment","bitform"),children:(0,u.jsxs)("div",{className:"o-a",style:{height:"95%"},children:[(0,u.jsx)("div",{className:"mt-2",children:(0,s.__)("Select file upload fields","bitform")}),(0,u.jsx)(i.Z,{defaultValue:U.actions.attachments,className:"mt-2 w-5",onChange:function(e){return ee(e,"attachments")},options:V.filter((function(e){return"file-up"===e.type})).map((function(e){return{label:e.name,value:e.key}}))}),"private"===(null==(Z=U.default)||null==(S=Z.teamFolders)||null==(F=S[U.team])||null==(I=F[P])?void 0:I.type)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"btcd-hr mt-2"}),(0,u.jsxs)("div",{className:"flx mt-2",children:[(0,u.jsx)("div",{children:"Share with users: (optional)"}),(0,u.jsx)("button",{onClick:function(){return(0,f.n)(O,U,E,J,B)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Team Users"'},type:"button",disabled:q,children:"â†»"})]}),q&&(0,u.jsx)(r.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}),null==(T=U.actions)||null==(R=T.share)||null==(A=R.file)||null==(M=A.permissions)?void 0:M.map((function(e,t){return(0,u.jsxs)("div",{className:"flx flx-between mt-2",children:[(0,u.jsx)(i.Z,{defaultValue:e.email,className:"btcd-paper-drpdwn w-7 mr-2",onChange:function(e){return te(t,"email",e,"file")},options:X}),(0,u.jsx)("input",{type:"text",value:e.accessLabel,className:"btcd-paper-inp w-3",readOnly:!0})]},e.accessLabel)})),(0,u.jsx)(o.Z,{onChange:function(e){return ee(e,"mail","file")},checked:"true"===(null==U||null==(L=U.actions)||null==(W=L.share)||null==(z=W.file)?void 0:z.mail)||!1,className:"wd-100 mt-4 mr-2",value:"true",title:(0,s.__)("Send Notification Mail","bitform")})]})]})})]})}function h(e){var t,a,l,n=e.formID,i=e.formFields,o=e.workDriveConf,c=e.setWorkDriveConf,d=e.isLoading,h=e.setisLoading,p=e.setSnackbar;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("br",{}),(0,u.jsx)("b",{className:"wdt-100 d-in-b",children:(0,s.__)("Team:","bitform")}),(0,u.jsxs)("select",{onChange:function(e){return(0,f.Rx)(e,o,c,n,h,p)},name:"team",value:o.team,className:"btcd-paper-inp w-7",children:[(0,u.jsx)("option",{value:"",children:(0,s.__)("Select Team","bitform")}),(null==o||null==(t=o.default)?void 0:t.teams)&&Object.values(o.default.teams).map((function(e){return(0,u.jsx)("option",{value:e.teamId,children:e.teamName},e.teamId)}))]}),(0,u.jsx)("button",{onClick:function(){return(0,f.V9)(n,o,c,h,p)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":"'"+(0,s.__)("Refresh WorkDrive Teams","bitform")+"'"},type:"button",disabled:d,children:"â†»"}),(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),(0,u.jsx)("b",{className:"wdt-100 d-in-b",children:"Folder:"}),(0,u.jsxs)("select",{onChange:function(e){return(0,f.Rx)(e,o,c,n,h,p,0)},name:"folder",value:o.folderMap[0]||o.folder,className:"btcd-paper-inp w-7",children:[(0,u.jsx)("option",{value:"",children:(0,s.__)("Select Folder","bitform")}),(null==o||null==(a=o.default)||null==(l=a.teamFolders)?void 0:l[o.team])&&Object.values(o.default.teamFolders[o.team]).map((function(e){return(0,u.jsx)("option",{value:e.teamFolderId,children:e.teamFolderName},e.teamFolderId)}))]}),(0,u.jsx)("button",{onClick:function(){return(0,f.B5)(n,o,c,h,p)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":"'"+(0,s.__)("Refresh WorkDrive Team Folders","bitform")+"'"},type:"button",disabled:d,children:"â†»"}),(0,u.jsx)("br",{}),o.folderMap.map((function(e,t){var a,r;return(0,u.jsxs)("div",{children:[(0,u.jsx)("br",{}),(0,u.jsxs)("div",{className:"flx",children:[(0,u.jsx)("b",{className:"wdt-100 d-in-b"}),(0,u.jsx)("div",{className:"d-in-b",style:{width:10*(t+1),marginLeft:1,marginRight:2,height:58,marginTop:-60},children:(0,u.jsx)("div",{className:"sub-tree"})}),(0,u.jsxs)("div",{className:"flx sub-folder w-7",children:[(0,u.jsxs)("select",{onChange:function(e){return(0,f.Rx)(e,o,c,n,h,p,t+1)},name:"folder",value:o.folderMap[t+1]||o.folder,className:"btcd-paper-inp",children:[(0,u.jsx)("option",{value:o.folderMap[t],children:"/ root"}),(null==o||null==(a=o.default)||null==(r=a.folders)?void 0:r[e])&&o.default.folders[e].map((function(e){return(0,u.jsx)("option",{value:e.folderId,children:e.folderName},e.folderId)}))]}),(0,u.jsx)("button",{onClick:function(){return(0,f.ud)(n,o,c,h,p,t)},className:"d-non icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":"'"+(0,s.__)("Refresh Sub Folders","bitform")+"'"},type:"button",disabled:d,children:"â†»"})]})]})]},e)})),(0,u.jsx)("br",{}),(0,u.jsx)("br",{}),d&&(0,u.jsx)(r.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),o.folder&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"mt-4",children:(0,u.jsx)("b",{className:"wdt-100",children:(0,s.__)("Actions","bitform")})}),(0,u.jsx)("div",{className:"btcd-hr mt-1"}),(0,u.jsx)(m,{workDriveConf:o,setWorkDriveConf:c,formFields:i,formID:n,setisLoading:h,setSnackbar:p})]})]})}},8281:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(523),r=a(5893);function l(e){var t=e.action,a=e.children;return(0,r.jsxs)("div",{className:"action-btn-wrapper",children:[(0,r.jsx)("div",{className:"action-btn",tabIndex:"0",role:"button",onClick:t,onKeyPress:t,children:(0,r.jsx)(s.Z,{})}),a]})}}}]);