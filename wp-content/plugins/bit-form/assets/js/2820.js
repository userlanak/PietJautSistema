(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[2820],{2820:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var r=a(2122),n=a(7294),i=a(5637),s=a(9151),o=a(5257),d=a(4097),l=a(5893);function c(e){var t=e.formID,a=e.deskConf,c=e.setDeskConf,f=e.step,m=e.setstep,u=e.isLoading,h=e.setisLoading,_=e.setSnackbar,p=e.redirectLocation,b=e.isInfo,g=(0,n.useState)(!1),k=g[0],v=g[1],I=(0,n.useState)({dataCenter:"",clientId:"",clientSecret:""}),D=I[0],C=I[1],w=function(e){var t=(0,r.Z)({},a),n=(0,r.Z)({},D);n[e.target.name]="",t[e.target.name]=e.target.value,C(n),c(t)};return(0,l.jsxs)("div",{className:"btcd-stp-page",style:(0,r.Z)({},{width:1===f&&900},{height:1===f&&"100%"}),children:[(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("b",{children:(0,i.__)("Integration Name:","bitform")})}),(0,l.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:w,name:"name",value:a.name,type:"text",placeholder:(0,i.__)("Integration Name...","bitform"),disabled:b}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("b",{children:(0,i.__)("Data Center:","bitform")})}),(0,l.jsxs)("select",{onChange:w,name:"dataCenter",value:a.dataCenter,className:"btcd-paper-inp w-9 mt-1",disabled:b,children:[(0,l.jsx)("option",{value:"",children:(0,i.__)("--Select a data center--","bitform")}),(0,l.jsx)("option",{value:"com",children:"zoho.com"}),(0,l.jsx)("option",{value:"eu",children:"zoho.eu"}),(0,l.jsx)("option",{value:"com.cn",children:"zoho.com.cn"}),(0,l.jsx)("option",{value:"in",children:"zoho.in"}),(0,l.jsx)("option",{value:"com.au",children:"zoho.com.au"})]}),(0,l.jsx)("div",{style:{color:"red"},children:D.dataCenter}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("b",{children:(0,i.__)("Homepage URL:","bitform")})}),(0,l.jsx)(s.Z,{value:""+window.location.origin,setSnackbar:_,className:"field-key-cpy w-6 ml-0",readOnly:b}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("b",{children:(0,i.__)("Authorized Redirect URIs:","bitform")})}),(0,l.jsx)(s.Z,{value:p||window.location.href+"/redirect",setSnackbar:_,className:"field-key-cpy w-6 ml-0",readOnly:b}),(0,l.jsxs)("small",{className:"d-blk mt-5",children:[(0,i.__)("To get Client ID and SECRET , Please Visit","bitform")," ",(0,l.jsx)("a",{className:"btcd-link",href:"https://api-console.zoho."+((null==a?void 0:a.dataCenter)||"com")+"/",target:"_blank",rel:"noreferrer",children:(0,i.__)("Zoho API Console","bitform")})]}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("b",{children:(0,i.__)("Client id:","bitform")})}),(0,l.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:w,name:"clientId",value:a.clientId,type:"text",placeholder:(0,i.__)("Client id...","bitform"),disabled:b}),(0,l.jsx)("div",{style:{color:"red"},children:D.clientId}),(0,l.jsx)("div",{className:"mt-3",children:(0,l.jsx)("b",{children:(0,i.__)("Client secret:","bitform")})}),(0,l.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:w,name:"clientSecret",value:a.clientSecret,type:"text",placeholder:(0,i.__)("Client secret...","bitform"),disabled:b}),(0,l.jsx)("div",{style:{color:"red"},children:D.clientSecret}),!b&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{onClick:function(){return(0,d.P_)(a,c,C,v,h,_)},className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:k,children:[k?(0,i.__)("Authorized âœ”","bitform"):(0,i.__)("Authorize","bitform"),u&&(0,l.jsx)(o.Z,{size:"20",clr:"#022217",className:"ml-2"})]}),(0,l.jsx)("br",{}),(0,l.jsxs)("button",{onClick:function(){m(2),(0,d.Y6)(t,a,c,h,_),document.querySelector(".btcd-s-wrp").scrollTop=0},className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",disabled:!k,children:[(0,i.__)("Next","bitform"),(0,l.jsx)("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]})]})}},4097:function(e,t,a){"use strict";a.d(t,{Rx:function(){return s},Y6:function(){return l},$1:function(){return c},GX:function(){return f},oQ:function(){return m},Xr:function(){return u},Pd:function(){return _},P_:function(){return p}});var r=a(2122),n=a(5637),i=a(9492),s=function(e,t,a,n,i,s,l,c,f){var m=(0,r.Z)({},t);if(l){var u=(0,r.Z)({},c);u[e.target.name]="",f((0,r.Z)({},u))}switch(m[e.target.name]=e.target.value,e.target.name){case"orgId":m=o(m,n,a,i,s);break;case"department":m=d(m,n,a,i,s)}a((0,r.Z)({},m))},o=function(e,t,a,n,i){var s,o,d,l,f=(0,r.Z)({},e);return f.department="",f.field_map=[{formField:"",zohoFormField:""}],f.actions={},null!=f&&null!=(s=f.default)&&null!=(o=s.departments)&&o[f.orgId]?1===(null==f||null==(d=f.default)||null==(l=d.departments)?void 0:l[f.orgId].length)&&(f.field_map=h(f)):c(t,f,a,n,i),f},d=function(e,t,a,n,i){var s,o,d=(0,r.Z)({},e);return d.field_map=[{formField:"",zohoFormField:""}],d.actions={},null!=d&&null!=(s=d.default)&&null!=(o=s.fields)&&o[d.orgId]?d.field_map=h(d):f(t,d,a,n,i),d},l=function(e,t,a,s,o){s(!0);var d={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,i.Z)(d,"bitforms_zdesk_refresh_organizations").then((function(e){if(e&&e.success){var i=(0,r.Z)({},t);e.data.organizations&&(i.default=(0,r.Z)({},i.default,{organizations:e.data.organizations})),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,n.__)("Portals refreshed","bitform")}),a((0,r.Z)({},i))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,n.__)("Portals refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bitform")}):o({show:!0,msg:(0,n.__)("Portals refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))},c=function(e,t,a,s,o){s(!0);var d={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId};(0,i.Z)(d,"bitforms_zdesk_refresh_departments").then((function(i){if(i&&i.success){var d,l,c=(0,r.Z)({},t);if(c.default.departments||(c.default.departments={}),i.data.departments&&(c.default.departments[c.orgId]=i.data.departments),1===i.data.departments.length)c.department=i.data.departments[c.orgId][0].departmentName,(null==(d=c.default)||null==(l=d.fields)||!l[c.orgId])&&f(e,c,a,s,o);i.data.tokenDetails&&(c.tokenDetails=i.data.tokenDetails),o({show:!0,msg:(0,n.__)("Departments refreshed","bitform")}),a((0,r.Z)({},c))}else i&&i.data&&i.data.data||!i.success&&"string"===typeof i.data?o({show:!0,msg:(0,n.g)((0,n.__)("Departments refresh failed Cause: %s. please try again","bitform"),i.data.data||i.data)}):o({show:!0,msg:(0,n.__)("Departments refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))},f=function(e,t,a,s,o){s(!0);var d={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId};(0,i.Z)(d,"bitforms_zdesk_refresh_fields").then((function(e){if(e&&e.success){var i=(0,r.Z)({},t);e.data.fields?(i.default.fields||(i.default.fields={}),i.default.fields[i.orgId]=(0,r.Z)({},e.data),i.field_map=h(i),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,n.__)("Fields refreshed","bitform")})):o({show:!0,msg:""+(0,n.__)("Fields refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bitform")}),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),a((0,r.Z)({},i))}else o({show:!0,msg:(0,n.__)("Fields refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))},m=function(e,t,a,s,o){s(!0);var d={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId};(0,i.Z)(d,"bitforms_zdesk_refresh_owners").then((function(e){if(e&&e.success){var i=(0,r.Z)({},t);i.default.owners||(i.default.owners={}),e.data.owners&&(i.default.owners[i.orgId]=e.data.owners),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,n.__)("Owners refreshed","bitform")}),a((0,r.Z)({},i))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,n.__)("Owners refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bitform")}):o({show:!0,msg:(0,n.__)("Owners refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))},u=function(e,t,a,s,o){s(!0);var d={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId,departmentId:t.department};(0,i.Z)(d,"bitforms_zdesk_refresh_products").then((function(e){if(e&&e.success){var i=(0,r.Z)({},t);i.default.products||(i.default.products={}),e.data.products&&(i.default.products[i.department]=e.data.products),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,n.__)("Products refreshed","bitform")}),a((0,r.Z)({},i))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,n.__)("Products refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bitform")}):o({show:!0,msg:(0,n.__)("Products refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))},h=function(e){var t;return e.default.fields[e.orgId].required.length>0?null==(t=e.default.fields[e.orgId].required)?void 0:t.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]},_=function(e){return!((null!=e&&e.field_map?e.field_map.filter((function(t){var a,r,n;return!t.formField&&t.zohoFormField&&-1!==(null==e||null==(a=e.default)||null==(r=a.fields)||null==(n=r[e.orgId])?void 0:n.required.indexOf(t.zohoFormField))})):[]).length>0)},p=function(e,t,a,i,s,o){if(e.dataCenter&&e.clientId&&e.clientSecret){s(!0);var d="https://accounts.zoho."+e.dataCenter+"/oauth/v2/auth?scope=Desk.settings.READ,Desk.basic.READ,Desk.search.READ,Desk.contacts.READ,Desk.contacts.CREATE,Desk.contacts.UPDATE,Desk.tickets.CREATE,Desk.tickets.UPDATE&response_type=code&client_id="+e.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",l=window.open(d,"zohoDesk","width=400,height=609,toolbar=off"),c=setInterval((function(){if(l.closed){clearInterval(c);var a={},d=!1,f=localStorage.getItem("__bitforms_zohoDesk");if(f&&(d=!0,a=JSON.parse(f),localStorage.removeItem("__bitforms_zohoDesk")),a.code&&!a.error&&a&&d){var m=(0,r.Z)({},e);m.accountServer=a["accounts-server"],b(a,m,t,i,s,o)}else{var u=a.error?"Cause: "+a.error:"";o({show:!0,msg:(0,n.__)("Authorization failed","bitform")+" "+u+". "+(0,n.__)("please try again","bitform")}),s(!1)}}}),500)}else a({dataCenter:e.dataCenter?"":(0,n.__)("Data center cann't be empty","bitform"),clientId:e.clientId?"":(0,n.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,n.__)("Secret key cann't be empty","bitform")})},b=function(e,t,a,s,o,d){var l=(0,r.Z)({},e);l.dataCenter=t.dataCenter,l.clientId=t.clientId,l.clientSecret=t.clientSecret,l.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,i.Z)(l,"bitforms_zdesk_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var i=(0,r.Z)({},t);i.tokenDetails=e.data,a(i),s(!0),d({show:!0,msg:(0,n.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?d({show:!0,msg:""+(0,n.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,n.__)("please try again","bitform")}):d({show:!0,msg:(0,n.__)("Authorization failed. please try again","bitform")});o(!1)}))}}}]);