(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[4175],{5813:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var a=n(5637),s=n(5893);function r(e){var t=e.step,n=e.saveConfig,r=e.edit,i=e.disabled;return r?(0,s.jsx)("div",{className:"txt-center w-9 mt-3",children:(0,s.jsx)("button",{onClick:n,className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:i,children:(0,a.__)("Save","bitform")})}):(0,s.jsxs)("div",{className:"btcd-stp-page txt-center",style:{width:3===t&&"90%",height:3===t&&"100%"},children:[(0,s.jsx)("h2",{className:"ml-3",children:(0,a.__)("Successfully Integrated","bitform")}),(0,s.jsxs)("button",{onClick:n,className:"btn btcd-btn-lg green sh-sm",type:"button",children:[(0,a.__)("Finish & Save ","bitform"),"✔"]})]})}},4097:function(e,t,n){"use strict";n.d(t,{Rx:function(){return i},Y6:function(){return d},$1:function(){return c},GX:function(){return u},oQ:function(){return m},Xr:function(){return f},Pd:function(){return p},P_:function(){return b}});var a=n(2122),s=n(5637),r=n(9492),i=function(e,t,n,s,r,i,d,c,u){var m=(0,a.Z)({},t);if(d){var f=(0,a.Z)({},c);f[e.target.name]="",u((0,a.Z)({},f))}switch(m[e.target.name]=e.target.value,e.target.name){case"orgId":m=l(m,s,n,r,i);break;case"department":m=o(m,s,n,r,i)}n((0,a.Z)({},m))},l=function(e,t,n,s,r){var i,l,o,d,u=(0,a.Z)({},e);return u.department="",u.field_map=[{formField:"",zohoFormField:""}],u.actions={},null!=u&&null!=(i=u.default)&&null!=(l=i.departments)&&l[u.orgId]?1===(null==u||null==(o=u.default)||null==(d=o.departments)?void 0:d[u.orgId].length)&&(u.field_map=h(u)):c(t,u,n,s,r),u},o=function(e,t,n,s,r){var i,l,o=(0,a.Z)({},e);return o.field_map=[{formField:"",zohoFormField:""}],o.actions={},null!=o&&null!=(i=o.default)&&null!=(l=i.fields)&&l[o.orgId]?o.field_map=h(o):u(t,o,n,s,r),o},d=function(e,t,n,i,l){i(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,r.Z)(o,"bitforms_zdesk_refresh_organizations").then((function(e){if(e&&e.success){var r=(0,a.Z)({},t);e.data.organizations&&(r.default=(0,a.Z)({},r.default,{organizations:e.data.organizations})),e.data.tokenDetails&&(r.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,s.__)("Portals refreshed","bitform")}),n((0,a.Z)({},r))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:""+(0,s.__)("Portals refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}):l({show:!0,msg:(0,s.__)("Portals refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},c=function(e,t,n,i,l){i(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId};(0,r.Z)(o,"bitforms_zdesk_refresh_departments").then((function(r){if(r&&r.success){var o,d,c=(0,a.Z)({},t);if(c.default.departments||(c.default.departments={}),r.data.departments&&(c.default.departments[c.orgId]=r.data.departments),1===r.data.departments.length)c.department=r.data.departments[c.orgId][0].departmentName,(null==(o=c.default)||null==(d=o.fields)||!d[c.orgId])&&u(e,c,n,i,l);r.data.tokenDetails&&(c.tokenDetails=r.data.tokenDetails),l({show:!0,msg:(0,s.__)("Departments refreshed","bitform")}),n((0,a.Z)({},c))}else r&&r.data&&r.data.data||!r.success&&"string"===typeof r.data?l({show:!0,msg:(0,s.g)((0,s.__)("Departments refresh failed Cause: %s. please try again","bitform"),r.data.data||r.data)}):l({show:!0,msg:(0,s.__)("Departments refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},u=function(e,t,n,i,l){i(!0);var o={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId};(0,r.Z)(o,"bitforms_zdesk_refresh_fields").then((function(e){if(e&&e.success){var r=(0,a.Z)({},t);e.data.fields?(r.default.fields||(r.default.fields={}),r.default.fields[r.orgId]=(0,a.Z)({},e.data),r.field_map=h(r),e.data.tokenDetails&&(r.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,s.__)("Fields refreshed","bitform")})):l({show:!0,msg:""+(0,s.__)("Fields refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}),e.data.tokenDetails&&(r.tokenDetails=e.data.tokenDetails),n((0,a.Z)({},r))}else l({show:!0,msg:(0,s.__)("Fields refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},m=function(e,t,n,i,l){i(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId};(0,r.Z)(o,"bitforms_zdesk_refresh_owners").then((function(e){if(e&&e.success){var r=(0,a.Z)({},t);r.default.owners||(r.default.owners={}),e.data.owners&&(r.default.owners[r.orgId]=e.data.owners),e.data.tokenDetails&&(r.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,s.__)("Owners refreshed","bitform")}),n((0,a.Z)({},r))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:""+(0,s.__)("Owners refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}):l({show:!0,msg:(0,s.__)("Owners refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},f=function(e,t,n,i,l){i(!0);var o={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,orgId:t.orgId,departmentId:t.department};(0,r.Z)(o,"bitforms_zdesk_refresh_products").then((function(e){if(e&&e.success){var r=(0,a.Z)({},t);r.default.products||(r.default.products={}),e.data.products&&(r.default.products[r.department]=e.data.products),e.data.tokenDetails&&(r.tokenDetails=e.data.tokenDetails),l({show:!0,msg:(0,s.__)("Products refreshed","bitform")}),n((0,a.Z)({},r))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:""+(0,s.__)("Products refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}):l({show:!0,msg:(0,s.__)("Products refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},h=function(e){var t;return e.default.fields[e.orgId].required.length>0?null==(t=e.default.fields[e.orgId].required)?void 0:t.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]},p=function(e){return!((null!=e&&e.field_map?e.field_map.filter((function(t){var n,a,s;return!t.formField&&t.zohoFormField&&-1!==(null==e||null==(n=e.default)||null==(a=n.fields)||null==(s=a[e.orgId])?void 0:s.required.indexOf(t.zohoFormField))})):[]).length>0)},b=function(e,t,n,r,i,l){if(e.dataCenter&&e.clientId&&e.clientSecret){i(!0);var o="https://accounts.zoho."+e.dataCenter+"/oauth/v2/auth?scope=Desk.settings.READ,Desk.basic.READ,Desk.search.READ,Desk.contacts.READ,Desk.contacts.CREATE,Desk.contacts.UPDATE,Desk.tickets.CREATE,Desk.tickets.UPDATE&response_type=code&client_id="+e.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",d=window.open(o,"zohoDesk","width=400,height=609,toolbar=off"),c=setInterval((function(){if(d.closed){clearInterval(c);var n={},o=!1,u=localStorage.getItem("__bitforms_zohoDesk");if(u&&(o=!0,n=JSON.parse(u),localStorage.removeItem("__bitforms_zohoDesk")),n.code&&!n.error&&n&&o){var m=(0,a.Z)({},e);m.accountServer=n["accounts-server"],_(n,m,t,r,i,l)}else{var f=n.error?"Cause: "+n.error:"";l({show:!0,msg:(0,s.__)("Authorization failed","bitform")+" "+f+". "+(0,s.__)("please try again","bitform")}),i(!1)}}}),500)}else n({dataCenter:e.dataCenter?"":(0,s.__)("Data center cann't be empty","bitform"),clientId:e.clientId?"":(0,s.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,s.__)("Secret key cann't be empty","bitform")})},_=function(e,t,n,i,l,o){var d=(0,a.Z)({},e);d.dataCenter=t.dataCenter,d.clientId=t.clientId,d.clientSecret=t.clientSecret,d.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,r.Z)(d,"bitforms_zdesk_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var r=(0,a.Z)({},t);r.tokenDetails=e.data,n(r),i(!0),o({show:!0,msg:(0,s.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,s.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}):o({show:!0,msg:(0,s.__)("Authorization failed. please try again","bitform")});l(!1)}))}},7807:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var a=n(5637),s=n(8381),r=n(4383),i=n(2122),l=n(7294),o=n(7707),d=n(4401),c=n(3921),u=n(4097),m=n(5893);function f(e){var t,n,r,f,h,p,b=e.deskConf,_=e.setDeskConf,g=e.formID,x=e.formFields,v=e.setSnackbar,k=(0,l.useState)(!1),j=k[0],w=k[1],C=(0,l.useState)({show:!1}),D=C[0],I=C[1],y=function(e,t){var n=(0,i.Z)({},b);"ticket_owner"===t?""!==e?n.actions.ticket_owner=e:delete n.actions.ticket_owner:"product"===t?""!==e?n.actions.product=e:delete n.actions.product:"attachments"===t&&(""!==e?n.actions.attachments=e:delete n.actions.attachments),_((0,i.Z)({},n))},N=function(){I({show:!1})};return(0,m.jsxs)("div",{className:"pos-rel",children:[(0,m.jsxs)("div",{className:"d-flx flx-wrp",children:[(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,m.jsx)(c.Z,{onChange:function(){var e,t;null!=(e=b.default)&&null!=(t=e.owners)&&t[b.orgId]||(0,u.oQ)(g,b,_,w,v),I({show:"ticket_owner"})},checked:"ticket_owner"in b.actions,className:"wdt-200 mt-4 mr-2",value:"Ticket_Owner",title:(0,a.__)("Ticket Owner","bitform"),subTitle:(0,a.__)("Add a owner to ticket pushed to Zoho Desk.","bitform")}),!b.actions.ticket_owner&&(0,m.jsx)("small",{style:{marginLeft:30,marginTop:10,color:"red"},children:(0,a.__)("ticket owner is required","bitform")})]}),(0,m.jsx)(c.Z,{onChange:function(){var e,t;null!=(e=b.default)&&null!=(t=e.products)&&t[b.department]||(0,u.Xr)(g,b,_,w,v),I({show:"product"})},checked:"product"in b.actions,className:"wdt-200 mt-4 mr-2",value:"Product_Name",title:(0,a.__)("Product Name","bitform"),subTitle:(0,a.__)("Add a product to ticket pushed to Zoho Desk.","bitform")}),(0,m.jsx)(c.Z,{onChange:function(){return I({show:"attachments"})},checked:"attachments"in b.actions,className:"wdt-200 mt-4 mr-2",value:"Attachment",title:(0,a.__)("Attachments","bitform"),subTitle:(0,a.__)("Add attachments from BitForm to ticket pushed to Zoho Desk.","bitform")})]}),(0,m.jsxs)(d.Z,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:(0,a.__)("Ok","bitform"),show:"ticket_owner"===D.show,close:N,action:N,title:(0,a.__)("Ticket Owner","bitform"),children:[(0,m.jsx)("div",{className:"btcd-hr mt-2"}),j?(0,m.jsx)(s.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):(0,m.jsxs)("div",{className:"flx flx-between mt-2",children:[(0,m.jsxs)("select",{value:b.actions.ticket_owner,className:"btcd-paper-inp",onChange:function(e){return y(e.target.value,"ticket_owner")},children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Owner","bitform")}),null==(t=b.default)||null==(n=t.owners)||null==(r=n[b.orgId])?void 0:r.map((function(e){return(0,m.jsx)("option",{value:e.ownerId,children:e.ownerName},e.ownerId)}))]}),(0,m.jsx)("button",{onClick:function(){return(0,u.oQ)(g,b,_,w,v)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Ticket Owners"'},type:"button",disabled:j,children:"↻"})]})]}),(0,m.jsxs)(d.Z,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:(0,a.__)("Ok","bitform"),show:"product"===D.show,close:N,action:N,title:(0,a.__)("Product Name","bitform"),children:[(0,m.jsx)("div",{className:"btcd-hr mt-2"}),j?(0,m.jsx)(s.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):(0,m.jsxs)("div",{className:"flx flx-between mt-2",children:[(0,m.jsxs)("select",{value:b.actions.product,className:"btcd-paper-inp",onChange:function(e){return y(e.target.value,"product")},children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Product","bitform")}),null==(f=b.default)||null==(h=f.products)||null==(p=h[b.department])?void 0:p.map((function(e){return(0,m.jsx)("option",{value:e.productId,children:e.productName},e.productId)}))]}),(0,m.jsx)("button",{onClick:function(){return(0,u.Xr)(g,b,_,w,v)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Products"'},type:"button",disabled:j,children:"↻"})]})]}),(0,m.jsxs)(d.Z,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:(0,a.__)("Ok","bitform"),show:"attachments"===D.show,close:N,action:N,title:(0,a.__)("Select Attachment","bitform"),children:[(0,m.jsx)("div",{className:"btcd-hr mt-2"}),(0,m.jsx)("div",{className:"mt-2",children:(0,a.__)("Select file upload fields","bitform")}),(0,m.jsx)(o.Z,{defaultValue:b.actions.attachments,className:"mt-2 w-9",onChange:function(e){return y(e,"attachments")},options:x.filter((function(e){return"file-up"===e.type})).map((function(e){return{label:e.name,value:e.key}}))})]})]})}var h=n(8530);function p(e){var t,n,s,i,l=e.i,o=e.formFields,d=e.field,c=e.deskConf,u=e.setDeskConf,f=c.orgId,p=""===d.zohoFormField||-1===(null==(t=c.default.fields[f].required)?void 0:t.indexOf(d.zohoFormField));return(0,m.jsxs)("div",{className:"flx mt-2 mr-1",children:[(0,m.jsxs)("div",{className:"flx integ-fld-wrp",children:[(0,m.jsxs)("select",{className:"btcd-paper-inp mr-2",name:"formField",value:d.formField||"",onChange:function(e){return(0,r.wX)(e,l,c,u)},children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Field","bitform")}),o.map((function(e){return"file-up"!==e.type&&(0,m.jsx)("option",{value:e.key,children:e.name},"ff-zhcrm-"+e.key)})),(0,m.jsx)("option",{value:"custom",children:(0,a.__)("Custom...","bitform")})]}),"custom"===d.formField&&(0,m.jsx)(h.Z,{onChange:function(e){return(0,r.mG)(e,l,c,u)},label:(0,a.__)("Custom Value","bitform"),className:"mr-2",type:"text",value:d.customValue,placeholder:(0,a.__)("Custom Value","bitform")}),(0,m.jsxs)("select",{className:"btcd-paper-inp",name:"zohoFormField",value:d.zohoFormField||"",disabled:!p,onChange:function(e){return(0,r.wX)(e,l,c,u)},children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Field","bitform")}),(null==(n=c.default)||null==(s=n.fields)||null==(i=s[f])?void 0:i.fields)&&Object.values(c.default.fields[f].fields).map((function(e){return p?!1===e.required&&(0,m.jsx)("option",{value:e.apiName,children:e.displayLabel},e.displayLabel):(0,m.jsx)("option",{value:e.apiName,children:e.displayLabel},e.displayLabel)}))]})]}),p&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{onClick:function(){return(0,r.FP)(l,c,u)},className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),(0,m.jsx)("button",{onClick:function(){return(0,r.T5)(l,c,u)},className:"icn-btn sh-sm",type:"button","aria-label":"btn",children:(0,m.jsx)("span",{className:"btcd-icn icn-trash-2"})})]})]})}function b(e){var t,n,i,l,o,d=e.formID,c=e.formFields,h=e.handleInput,b=e.deskConf,_=e.setDeskConf,g=e.isLoading,x=e.setisLoading,v=e.setSnackbar;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("br",{}),(0,m.jsx)("b",{className:"wdt-100 d-in-b",children:(0,a.__)("Portal:","bitform")}),(0,m.jsxs)("select",{onChange:h,name:"orgId",value:b.orgId,className:"btcd-paper-inp w-7",children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Portal","bitform")}),(null==b||null==(t=b.default)?void 0:t.organizations)&&Object.values(b.default.organizations).map((function(e){return(0,m.jsx)("option",{value:e.orgId,children:e.portalName},e.orgId)}))]}),(0,m.jsx)("button",{onClick:function(){return(0,u.Y6)(d,b,_,x,v)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":"'"+(0,a.__)("Refresh Desk Portals","bitform")+"'"},type:"button",disabled:g,children:"↻"}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),(0,m.jsx)("b",{className:"wdt-100 d-in-b",children:(0,a.__)("Department:","bitform")}),(0,m.jsxs)("select",{onChange:h,name:"department",value:b.department,className:"btcd-paper-inp w-7",children:[(0,m.jsx)("option",{value:"",children:(0,a.__)("Select Department","bitform")}),(null==b||null==(n=b.default)||null==(i=n.departments)?void 0:i[b.orgId])&&Object.values(b.default.departments[b.orgId]).map((function(e){return(0,m.jsx)("option",{value:e.departmentId,children:e.departmentName},e.departmentId)}))]}),(0,m.jsx)("button",{onClick:function(){return(0,u.$1)(d,b,_,x,v)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":"'"+(0,a.__)("Refresh Desk Departments","bitform")+"'"},type:"button",disabled:g,children:"↻"}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),g&&(0,m.jsx)(s.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),b.department&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"mt-4",children:[(0,m.jsx)("b",{className:"wdt-100",children:(0,a.__)("Map Fields","bitform")}),(0,m.jsx)("button",{onClick:function(){return(0,u.GX)(d,b,_,x,v)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":"'"+(0,a.__)("Refresh Desk Fields","bitform")+"'"},type:"button",disabled:g,children:"↻"})]}),(0,m.jsx)("div",{className:"btcd-hr mt-1"}),(null==(l=b.default)||null==(o=l.fields)?void 0:o[null==b?void 0:b.orgId])&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"flx flx-around mt-2 mb-1",children:[(0,m.jsx)("div",{className:"txt-dp",children:(0,m.jsx)("b",{children:(0,a.__)("Form Fields","bitform")})}),(0,m.jsx)("div",{className:"txt-dp",children:(0,m.jsx)("b",{children:(0,a.__)("Zoho Fields","bitform")})})]}),b.field_map.map((function(e,t){return(0,m.jsx)(p,{i:t,field:e,deskConf:b,formFields:c,setDeskConf:_},"desk-m-"+(t+9))})),(0,m.jsx)("div",{className:"txt-center  mt-2",style:{marginRight:85},children:(0,m.jsx)("button",{onClick:function(){return(0,r.FP)(b.field_map.length,b,_)},className:"icn-btn sh-sm",type:"button",children:"+"})}),(0,m.jsx)("br",{}),(0,m.jsx)("br",{}),(0,m.jsx)("div",{className:"mt-4",children:(0,m.jsx)("b",{className:"wdt-100",children:(0,a.__)("Actions","bitform")})}),(0,m.jsx)("div",{className:"btcd-hr mt-1"}),(0,m.jsx)(f,{deskConf:b,setDeskConf:_,formID:d,formFields:c,setSnackbar:v})]})]})]})}},8530:function(e,t,n){"use strict";var a=n(5893);t.Z=function(e){var t=e.label,n=e.onChange,s=e.value,r=e.disabled,i=e.type,l=e.textarea,o=e.className;return(0,a.jsxs)("label",{className:"btcd-mt-inp "+o,children:[!l&&(0,a.jsx)("input",{type:void 0===i?"text":i,onChange:n,placeholder:" ",disabled:r,value:s}),l&&(0,a.jsx)("textarea",{type:void 0===i?"text":i,onChange:n,placeholder:" ",disabled:r,value:s}),(0,a.jsx)("span",{children:t})]})}}}]);