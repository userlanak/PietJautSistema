(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[3324],{5813:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(5637),r=s(5893);function n(e){var t=e.step,s=e.saveConfig,n=e.edit,o=e.disabled;return n?(0,r.jsx)("div",{className:"txt-center w-9 mt-3",children:(0,r.jsx)("button",{onClick:s,className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:o,children:(0,a.__)("Save","bitform")})}):(0,r.jsxs)("div",{className:"btcd-stp-page txt-center",style:{width:3===t&&"90%",height:3===t&&"100%"},children:[(0,r.jsx)("h2",{className:"ml-3",children:(0,a.__)("Successfully Integrated","bitform")}),(0,r.jsxs)("button",{onClick:s,className:"btn btcd-btn-lg green sh-sm",type:"button",children:[(0,a.__)("Finish & Save ","bitform"),"✔"]})]})}},4917:function(e,t,s){"use strict";s.d(t,{Rx:function(){return o},h4:function(){return c},Co:function(){return d},kS:function(){return h},P_:function(){return u}});var a=s(2122),r=s(5637),n=s(9492),o=function(e,t,s,r,n,o,c,d,h){var u=(0,a.Z)({},t);if(c){var f=(0,a.Z)({},d);f[e.target.name]="",h((0,a.Z)({},f))}switch(u[e.target.name]=e.target.value,e.target.name){case"workbook":u=i(u,r,s,n,o);break;case"worksheet":u=l(u,r,s,n,o)}s((0,a.Z)({},u))},i=function(e,t,s,r,n){var o,i,l,c,u=(0,a.Z)({},e);if(u.worksheet="",u.field_map=[{formField:"",zohoFormField:""}],null!=u&&null!=(o=u.default)&&null!=(i=o.worksheets)&&i[e.workbook]){if(1===Object.keys(null==u||null==(l=u.default)||null==(c=l.worksheets)?void 0:c[e.workbook]).length){var f,m,b,k,p;u.worksheet=null==u||null==(f=u.default)||null==(m=f.worksheets)?void 0:m[e.workbook][0].viewName,null!=u&&null!=(b=u.default)&&null!=(k=b.worksheets)&&null!=(p=k.headers)&&p[u.worksheet]||h(t,u,s,r,n)}}else d(t,u,s,r,n);return u},l=function(e,t,s,r,n){var o,i,l,c=(0,a.Z)({},e);return c.field_map=[{formField:"",zohoFormField:""}],null!=c&&null!=(o=c.default)&&null!=(i=o.worksheets)&&null!=(l=i.headers)&&l[e.worksheet]||h(t,c,s,r,n),c},c=function(e,t,s,o,i){o(!0);var l={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,ownerEmail:t.ownerEmail};(0,n.Z)(l,"bitforms_zsheet_refresh_workbooks").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);n.default||(n.default={}),e.data.workbooks&&(n.default.workbooks=e.data.workbooks),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),i({show:!0,msg:(0,r.__)("Workbooks refreshed","bitform")}),s((0,a.Z)({},n))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?i({show:!0,msg:(0,r.g)((0,r.__)("Workbooks refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):i({show:!0,msg:(0,r.__)("Workbooks refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))},d=function(e,t,s,o,i){var l=t.workbook;if(l){o(!0);var c={formID:e,workbook:l,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,n.Z)(c,"bitforms_zsheet_refresh_worksheets").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);e.data.worksheets&&(n.default.worksheets||(n.default.worksheets={}),n.default.worksheets[l]=e.data.worksheets),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),i({show:!0,msg:(0,r.__)("Worksheets refreshed","bitform")}),s((0,a.Z)({},n))}else i({show:!0,msg:(0,r.__)("Worksheets refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))}},h=function(e,t,s,o,i){var l=t.workbook,c=t.worksheet,d=t.headerRow;if(c){o(!0);var h={formID:e,workbook:l,worksheet:c,headerRow:d,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,ownerEmail:t.ownerEmail};(0,n.Z)(h,"bitforms_zsheet_refresh_worksheet_headers").then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);e.data.worksheet_headers.length>0?(n.default.worksheets.headers||(n.default.worksheets.headers={}),n.default.worksheets.headers[c]||(n.default.worksheets.headers[c]={}),n.default.worksheets.headers[c][d]=e.data.worksheet_headers,e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),i({show:!0,msg:(0,r.__)("Worksheet Headers refreshed","bitform")})):i({show:!0,msg:(0,r.__)("No Worksheet headers found. Try changing the header row number or try again","bitform")}),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),s((0,a.Z)({},n))}else i({show:!0,msg:(0,r.__)("Worksheet Headers refresh failed. please try again","bitform")});o(!1)})).catch((function(){return o(!1)}))}},u=function(e,t,s,n,o,i){if(e.dataCenter&&e.clientId&&e.clientSecret){o(!0);var l="https://accounts.zoho."+e.dataCenter+"/oauth/v2/auth?scope=ZohoSheet.dataAPI.READ,ZohoSheet.dataAPI.UPDATE&response_type=code&client_id="+e.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",c=window.open(l,"zohoSheet","width=400,height=609,toolbar=off"),d=setInterval((function(){if(c.closed){clearInterval(d);var s={},l=!1,h=localStorage.getItem("__bitforms_zohoSheet");if(h&&(l=!0,s=JSON.parse(h),localStorage.removeItem("__bitforms_zohoSheet")),s.code&&!s.error&&s&&l){var u=(0,a.Z)({},e);u.accountServer=s["accounts-server"],f(s,u,t,n,o,i)}else{var m=s.error?"Cause: "+s.error:"";i({show:!0,msg:(0,r.__)("Authorization failed","bitform")+" "+m+". "+(0,r.__)("please try again","bitform")}),o(!1)}}}),500)}else s({dataCenter:e.dataCenter?"":(0,r.__)("Data center cann't be empty","bitform"),clientId:e.clientId?"":(0,r.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,r.__)("Secret key cann't be empty","bitform")})},f=function(e,t,s,o,i,l){var c=(0,a.Z)({},e);c.dataCenter=t.dataCenter,c.clientId=t.clientId,c.clientSecret=t.clientSecret,c.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,n.Z)(c,"bitforms_zsheet_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var n=(0,a.Z)({},t);n.tokenDetails=e.data,s(n),o(!0),l({show:!0,msg:(0,r.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:""+(0,r.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):l({show:!0,msg:(0,r.__)("Authorization failed. please try again","bitform")});i(!1)}))}},8667:function(e,t,s){"use strict";s.d(t,{Z:function(){return w}});var a=s(5637),r=s(8381),n=s(4383),o=s(2122),i=s(7294),l=s(7707),c=s(8692),d=s(3921),h=s(8762),u=s(8281),f=s(5893);function m(e){var t,s,r,n,m,b,k,p,w,_,x,v,j,g,C,N=e.sheetConf,y=e.setSheetConf,Z=e.formFields,S=(0,i.useState)(!1),F=S[0],I=S[1],D=(0,i.useState)({show:!1}),R=D[0],z=D[1],W=function(e,t){var s=(0,o.Z)({},N);s.actions.update[t]=e,y((0,o.Z)({},s))},M=function(){var e=[{title:"Form Fields",type:"group",childs:[]}];return e[0].childs=Z.map((function(e){return{label:e.name,value:"${"+e.key+"}"}})),e};return(0,i.useEffect)((function(){var e,t;if(!F&&(null==(e=N.actions)||null==(t=e.update)||!t.criteria)){var s=(0,o.Z)({},N);delete s.actions.update,y((0,o.Z)({},s))}}),[F]),(0,f.jsxs)("div",{className:"pos-rel",children:[(0,f.jsxs)("div",{className:"d-flx flx-wrp",children:[(null==(t=N.default)||null==(s=t.worksheets)||null==(r=s.headers)||null==(n=r[N.worksheet])?void 0:n[N.headerRow])&&(0,f.jsx)(u.Z,{action:function(){var e;if(null==(e=N.actions)||!e.update){var t=(0,o.Z)({},N);t.actions.update={insert:!0,criteria:"",firstMatch:!1},y((0,o.Z)({},t))}I(!0)},children:(0,f.jsx)(d.Z,{onChange:function(e){return function(e,t){var s,a=(0,o.Z)({},N);"update"===t&&(!e.target.checked||null!=a&&null!=(s=a.actions)&&s.update?delete a.actions.update:(a.actions.update={insert:!0,criteria:"",firstMatch:!1},I(!0))),y((0,o.Z)({},a))}(e,"update")},checked:"update"in(null==N?void 0:N.actions),className:"wdt-200 mt-4 mr-2",value:"Upsert_Record",title:(0,a.__)("Update Row","bitform"),subTitle:(0,a.__)("Control how the row gets updated.","bitform")})}),(0,f.jsx)(d.Z,{onChange:function(){var e=(0,o.Z)({},N);e.actions.share||(e.actions.share=[{email:"",field:"",access:"view",accessLabel:"Read Only"},{email:"",field:"",access:"view_and_comment",accessLabel:"Read/Comment"},{email:"",field:"",access:"edit",accessLabel:"Read/Edit"},{email:"",field:"",access:"share",accessLabel:"Co-Owner"},{email:"",field:"",access:"remove_share",accessLabel:"Remove Share"}]),y((0,o.Z)({},e)),z({show:"share"})},checked:(null==N||null==(m=N.actions)||null==(b=m.share)?void 0:b.find((function(e){return e.email})))||!1,className:"wdt-200 mt-4 mr-2",value:"user_share",title:(0,a.__)("Share Workbook","bitform"),subTitle:(0,a.__)("Share workbook with users pushed to Zoho Sheet.","bitform")})]}),(0,f.jsx)(h.Z,{md:!0,show:F,setModal:I,title:(0,a.__)("Update Row","bitform"),children:(0,f.jsx)("div",{className:"o-a",children:(null==N||null==(k=N.actions)?void 0:k.update)&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("small",{children:(0,a.__)("Enter the criteria to update rows. Please use the below format.","bitform")}),(0,f.jsx)("br",{}),(0,f.jsxs)("div",{className:"mt-4",children:[(0,f.jsxs)("small",{children:["Example: ",'("Month"="March" or "Month"="April") and "Amount">30']}),(0,f.jsx)("br",{}),(0,f.jsx)("small",{children:"Here Month and Amount are Zoho Sheet's worksheet header name"})," ",(0,f.jsx)("span",{className:"icn-btn ml-2 tooltip",style:{"--tooltip-txt":'"Supported Relational Operators: =, !=, <, >, <=, >=, contains"',fontSize:15},children:(0,f.jsx)("span",{className:"btcd-icn icn-information-outline"})}),(0,f.jsx)("textarea",{name:"",rows:"5",className:"btcd-paper-inp mt-1",onChange:function(e){return W(e.target.value,"criteria")},value:null==(p=N.actions)||null==(w=p.update)?void 0:w.criteria})]}),(0,f.jsx)("div",{className:"font-w-m mt-3",children:(0,a.__)("Update Preferance","bitform")}),(0,f.jsx)("small",{children:(0,a.__)("update row for first match only?","bitform")}),(0,f.jsxs)("div",{children:[(0,f.jsx)(c.Z,{onChange:function(){return W(!0,"firstMatch")},radio:!0,checked:null==(_=N.actions.update)?void 0:_.firstMatch,name:"firstMatch",title:(0,a.__)("Yes","bitform")}),(0,f.jsx)(c.Z,{onChange:function(){return W(!1,"firstMatch")},radio:!0,checked:!(null!=(x=N.actions.update)&&x.firstMatch),name:"firstMatch",title:(0,a.__)("No","bitform")})]}),(0,f.jsx)("small",{children:(0,a.__)("insert new row if the above criteria doesn't met?","bitform")}),(0,f.jsxs)("div",{children:[(0,f.jsx)(c.Z,{onChange:function(){return W(!0,"insert")},radio:!0,checked:null==(v=N.actions.update)?void 0:v.insert,name:"up-row",title:(0,a.__)("Yes","bitform")}),(0,f.jsx)(c.Z,{onChange:function(){return W(!1,"insert")},radio:!0,checked:!(null!=(j=N.actions.update)&&j.insert),name:"up-row",title:(0,a.__)("No","bitform")})]})]})})}),(0,f.jsx)(h.Z,{md:!0,show:"share"===R.show,setModal:function(){return z({show:!1})},title:(0,a.__)("Share Settings","bitform"),children:(0,f.jsx)("div",{className:"o-a",style:{height:"95%"},children:(null==N||null==(g=N.actions)||null==(C=g.share)?void 0:C.length)>0&&N.actions.share.map((function(e,t){return(0,f.jsxs)("div",{className:"flx flx-between mt-2",children:[(0,f.jsx)(l.Z,{className:"btcd-paper-drpdwn w-7 mr-2",placeholder:"Input Email Address(s)",defaultValue:e.email,onChange:function(e){return function(e,t,s){var a,r=(0,o.Z)({},N);null!=(a=r.actions)&&a.share||(r.actions.share=[]),r.actions.share[e][t]=s,y((0,o.Z)({},r))}(t,"email",e)},options:M(),customValue:!0}),(0,f.jsx)("input",{className:"btcd-paper-inp w-3",type:"text",value:e.accessLabel,readOnly:!0})]},e.accessLabel)}))})})]})}var b=s(4917),k=s(8530);function p(e){var t,s,r,o=e.i,i=e.formFields,l=e.field,c=e.sheetConf,d=e.setSheetConf;return(0,f.jsxs)("div",{className:"flx mt-2 mr-1",children:[(0,f.jsxs)("div",{className:"flx integ-fld-wrp",children:[(0,f.jsxs)("select",{className:"btcd-paper-inp mr-2",name:"formField",value:l.formField||"",onChange:function(e){return(0,n.wX)(e,o,c,d)},children:[(0,f.jsx)("option",{value:"",children:(0,a.__)("Select Field","bitform")}),i.map((function(e){return"file-up"!==e.type&&(0,f.jsx)("option",{value:e.key,children:e.name},"ff-zhcrm-"+e.key)})),(0,f.jsx)("option",{value:"custom",children:(0,a.__)("Custom...","bitform")})]}),"custom"===l.formField&&(0,f.jsx)(k.Z,{onChange:function(e){return(0,n.mG)(e,o,c,d)},label:(0,a.__)("Custom Value","bitform"),className:"mr-2",type:"text",value:l.customValue,placeholder:(0,a.__)("Custom Value","bitform")}),(0,f.jsxs)("select",{className:"btcd-paper-inp",name:"zohoFormField",value:l.zohoFormField||"",onChange:function(e){return(0,n.wX)(e,o,c,d)},children:[(0,f.jsx)("option",{value:"",children:(0,a.__)("Select Field","bitform")}),(null==(t=c.default.worksheets)||null==(s=t.headers)||null==(r=s[c.worksheet])?void 0:r[c.headerRow])&&Object.values(c.default.worksheets.headers[c.worksheet][c.headerRow]).map((function(e){return(0,f.jsx)("option",{value:e,children:e},e+"-1")}))]})]}),(0,f.jsx)("button",{onClick:function(){return(0,n.FP)(o,c,d)},className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),(0,f.jsx)("button",{onClick:function(){return(0,n.T5)(o,c,d)},className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:(0,f.jsx)("span",{className:"btcd-icn icn-trash-2"})})]})}function w(e){var t,s,o,i,l,c,d,h=e.formID,u=e.formFields,k=e.handleInput,w=e.sheetConf,_=e.setSheetConf,x=e.isLoading,v=e.setisLoading,j=e.setSnackbar;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("br",{}),(0,f.jsx)("b",{className:"wdt-150 d-in-b",children:(0,a.__)("Workbook:","bitform")}),(0,f.jsxs)("select",{onChange:k,name:"workbook",value:w.workbook,className:"btcd-paper-inp w-7",children:[(0,f.jsx)("option",{value:"",children:(0,a.__)("Select Workbook","bitform")}),(null==w||null==(t=w.default)?void 0:t.workbooks)&&Object.keys(w.default.workbooks).map((function(e){return(0,f.jsx)("option",{value:w.default.workbooks[e].workbookId,children:w.default.workbooks[e].workbookName},e)}))]}),(0,f.jsx)("button",{onClick:function(){return(0,b.h4)(h,w,_,v,j)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Workbooks"'},type:"button",disabled:x,children:"↻"}),(0,f.jsx)("br",{}),(0,f.jsx)("br",{}),(0,f.jsx)("b",{className:"wdt-150 d-in-b",children:"Worksheet:"}),(0,f.jsxs)("select",{onChange:k,name:"worksheet",value:w.worksheet,className:"btcd-paper-inp w-7",children:[(0,f.jsx)("option",{value:"",children:(0,a.__)("Select Worksheet","bitform")}),(null==w||null==(s=w.default)||null==(o=s.worksheets)?void 0:o[w.workbook])&&w.default.worksheets[w.workbook].map((function(e){return(0,f.jsx)("option",{value:e,children:e},e)}))]}),(0,f.jsx)("button",{onClick:function(){return(0,b.Co)(h,w,_,v,j)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Worksheets"'},type:"button",disabled:x,children:"↻"}),(0,f.jsx)("br",{}),(0,f.jsx)("br",{}),(0,f.jsx)("b",{className:"wdt-150 d-in-b",children:(0,a.__)("Header Row:","bitform")}),(0,f.jsx)("input",{type:"number",min:"1",className:"btcd-paper-inp w-4",placeholder:"Header Row",onChange:k,value:w.headerRow,name:"headerRow"}),(0,f.jsx)("button",{onClick:function(){return(0,b.kS)(h,w,_,v,j)},className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Worksheet Headers"'},type:"button",disabled:x,children:"↻"}),(0,f.jsx)("br",{}),(0,f.jsx)("small",{className:"mt-3 d-blk",style:{marginLeft:155,lineHeight:1.8},children:(0,a.__)("By default, first row of the worksheet is considered as header row. This can be used if tabular data starts from any row other than the first row.","bitform")}),(0,f.jsx)("br",{}),x&&(0,f.jsx)(r.default,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),(null==(i=w.default)||null==(l=i.worksheets)||null==(c=l.headers)||null==(d=c[w.worksheet])?void 0:d[w.headerRow])&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"mt-4",children:(0,f.jsx)("b",{className:"wdt-100",children:(0,a.__)("Map Fields","bitform")})}),(0,f.jsx)("div",{className:"btcd-hr mt-1"}),(0,f.jsxs)("div",{className:"flx flx-around mt-2 mb-1",children:[(0,f.jsx)("div",{className:"txt-dp",children:(0,f.jsx)("b",{children:(0,a.__)("Form Fields","bitform")})}),(0,f.jsx)("div",{className:"txt-dp",children:(0,f.jsx)("b",{children:(0,a.__)("Zoho Fields","bitform")})})]}),w.field_map.map((function(e,t){return(0,f.jsx)(p,{i:t,field:e,sheetConf:w,formFields:u,setSheetConf:_},"sheet-m-"+(t+9))})),(0,f.jsx)("div",{className:"txt-center  mt-2",style:{marginRight:85},children:(0,f.jsx)("button",{onClick:function(){return(0,n.FP)(w.field_map.length,w,_)},className:"icn-btn sh-sm",type:"button",children:"+"})}),(0,f.jsx)("br",{}),(0,f.jsx)("br",{})]}),w.workbook&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"mt-4",children:(0,f.jsx)("b",{className:"wdt-100",children:(0,a.__)("Actions","bitform")})}),(0,f.jsx)("div",{className:"btcd-hr mt-1"}),(0,f.jsx)(m,{sheetConf:w,setSheetConf:_,formFields:u})]})]})}},8530:function(e,t,s){"use strict";var a=s(5893);t.Z=function(e){var t=e.label,s=e.onChange,r=e.value,n=e.disabled,o=e.type,i=e.textarea,l=e.className;return(0,a.jsxs)("label",{className:"btcd-mt-inp "+l,children:[!i&&(0,a.jsx)("input",{type:void 0===o?"text":o,onChange:s,placeholder:" ",disabled:n,value:r}),i&&(0,a.jsx)("textarea",{type:void 0===o?"text":o,onChange:s,placeholder:" ",disabled:n,value:r}),(0,a.jsx)("span",{children:t})]})}},8281:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(523),r=s(5893);function n(e){var t=e.action,s=e.children;return(0,r.jsxs)("div",{className:"action-btn-wrapper",children:[(0,r.jsx)("div",{className:"action-btn",tabIndex:"0",role:"button",onClick:t,onKeyPress:t,children:(0,r.jsx)(a.Z,{})}),s]})}}}]);