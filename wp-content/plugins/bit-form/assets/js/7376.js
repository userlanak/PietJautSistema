(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[7376],{1553:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var r=a(2122),s=a(7294),n=a(5637),i=a(9151),o=a(5257),l=a(3037),d=a(5893);function c(e){var t=e.formID,a=e.sheetConf,c=e.setSheetConf,h=e.step,f=e.setstep,u=e.isLoading,m=e.setisLoading,_=e.setSnackbar,g=e.redirectLocation,b=e.isInfo,p=(0,s.useState)(!1),k=p[0],w=p[1],v=(0,s.useState)({clientId:"",clientSecret:""}),I=v[0],S=v[1],x=function(e){var t=(0,r.Z)({},a),s=(0,r.Z)({},I);s[e.target.name]="",t[e.target.name]=e.target.value,S(s),c(t)};return(0,d.jsxs)("div",{className:"btcd-stp-page",style:(0,r.Z)({},{width:1===h&&900},{height:1===h&&"100%"}),children:[(0,d.jsx)("div",{className:"mt-3",children:(0,d.jsx)("b",{children:(0,n.__)("Integration Name:","bitform")})}),(0,d.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:x,name:"name",value:a.name,type:"text",placeholder:(0,n.__)("Integration Name...","bitform"),disabled:b}),(0,d.jsx)("div",{className:"mt-3",children:(0,d.jsx)("b",{children:(0,n.__)("Homepage URL:","bitform")})}),(0,d.jsx)(i.Z,{value:""+window.location.origin,setSnackbar:_,className:"field-key-cpy w-6 ml-0",readOnly:b}),(0,d.jsx)("div",{className:"mt-3",children:(0,d.jsx)("b",{children:(0,n.__)("Authorized Redirect URIs:","bitform")})}),(0,d.jsx)(i.Z,{value:g||""+bits.googleRedirectURL,setSnackbar:_,className:"field-key-cpy w-6 ml-0",readOnly:b}),(0,d.jsxs)("small",{className:"d-blk mt-5",children:[(0,n.__)("To get Client ID and SECRET , Please Visit","bitform")," ",(0,d.jsx)("a",{className:"btcd-link",href:"https://console.developers.google.com/apis/credentials",target:"_blank",rel:"noreferrer",children:(0,n.__)("Google API Console","bitform")})]}),(0,d.jsx)("div",{className:"mt-3",children:(0,d.jsx)("b",{children:(0,n.__)("Client id:","bitform")})}),(0,d.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:x,name:"clientId",value:a.clientId,type:"text",placeholder:(0,n.__)("Client id...","bitform"),disabled:b}),(0,d.jsx)("div",{style:{color:"red",fontSize:"15px"},children:I.clientId}),(0,d.jsx)("div",{className:"mt-3",children:(0,d.jsx)("b",{children:(0,n.__)("Client secret:","bitform")})}),(0,d.jsx)("input",{className:"btcd-paper-inp w-6 mt-1",onChange:x,name:"clientSecret",value:a.clientSecret,type:"text",placeholder:(0,n.__)("Client secret...","bitform"),disabled:b}),(0,d.jsx)("div",{style:{color:"red",fontSize:"15px"},children:I.clientSecret}),!b&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("button",{onClick:function(){return(0,l.P_)(a,c,S,w,m,_)},className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:k,children:[k?(0,n.__)("Authorized ✔","bitform"):(0,n.__)("Authorize","bitform"),u&&(0,d.jsx)(o.Z,{size:"20",clr:"#022217",className:"ml-2"})]}),(0,d.jsx)("br",{}),(0,d.jsxs)("button",{onClick:function(){return f(2),(0,l.de)(t,a,c,m,_),void(document.querySelector(".btcd-s-wrp").scrollTop=0)},className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",disabled:!k,children:[(0,n.__)("Next","bitform")," "," ",(0,d.jsx)("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]})]})}},3037:function(e,t,a){"use strict";a.d(t,{Rx:function(){return o},de:function(){return c},Co:function(){return h},kS:function(){return f},P_:function(){return u}});var r=a(2122),s=a(5637),n=a(9492),i=a(2249),o=function(e,t,a,s,n,i,o,c,h){var f=(0,r.Z)({},t);if(o){var u=(0,r.Z)({},c);u[e.target.name]="",h((0,r.Z)({},u))}switch(f[e.target.name]=e.target.value,e.target.name){case"spreadsheetId":f=l(f,s,a,n,i);break;case"worksheetName":f=d(f,s,a,n,i)}a((0,r.Z)({},f))},l=function(e,t,a,r,s){var n,o,l,d,c=(0,i.p$)(e);if(c.worksheetName="",c.headerRow="A1",c.field_map=[{formField:"",googleSheetField:""}],null!=c&&null!=(n=c.default)&&null!=(o=n.worksheets)&&o[e.spreadsheetId]){if(1===Object.keys(null==c||null==(l=c.default)||null==(d=l.worksheets)?void 0:d[e.spreadsheetId]).length){var u,m,_,g,b;c.worksheetName=null==c||null==(u=c.default)||null==(m=u.worksheets)?void 0:m[e.spreadsheetId][0].properties.title,null!=c&&null!=(_=c.default)&&null!=(g=_.worksheets)&&null!=(b=g.headers)&&b[c.worksheetName]||f(t,c,a,r,s)}}else h(t,c,a,r,s);return c},d=function(e,t,a,s,n){var i,o,l,d=(0,r.Z)({},e);return d.headerRow="A1",d.field_map=[{formField:"",googleSheetField:""}],null!=d&&null!=(i=d.default)&&null!=(o=i.worksheets)&&null!=(l=o.headers)&&l[e.worksheetName]||f(t,d,a,s,n),d},c=function(e,t,a,i,o){i(!0);var l={formID:e,id:t.id,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails,ownerEmail:t.ownerEmail};(0,n.Z)(l,"bitforms_gsheet_refresh_spreadsheets").then((function(e){if(e&&e.success){var n=(0,r.Z)({},t);n.default||(n.default={}),e.data.spreadsheets&&(n.default.spreadsheets=e.data.spreadsheets),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,s.__)("Spreadsheet refreshed","bitform")}),a((0,r.Z)({},n))}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:(0,s.g)((0,s.__)("Spreadsheet refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):o({show:!0,msg:(0,s.__)("Spreadsheet refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},h=function(e,t,a,i,o){var l=t.spreadsheetId;if(l){i(!0);var d={formID:e,spreadsheetId:l,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,n.Z)(d,"bitforms_gsheet_refresh_worksheets").then((function(e){if(e&&e.success){var n=(0,r.Z)({},t);e.data.worksheets&&(n.default.worksheets||(n.default.worksheets={}),n.default.worksheets[l]=e.data.worksheets),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,s.__)("Worksheets refreshed","bitform")}),a((0,r.Z)({},n))}else o({show:!0,msg:(0,s.__)("Worksheets refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))}},f=function(e,t,a,i,o){var l=t.spreadsheetId,d=t.worksheetName,c=t.header,h=t.headerRow;if(l||d||c||h){i(!0);var f={formID:e,spreadsheetId:l,worksheetName:d,header:c,headerRow:h,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,n.Z)(f,"bitforms_gsheet_refresh_worksheet_headers").then((function(e){if(e&&e.success){var n,c=(0,r.Z)({},t);(null==(n=e.data.worksheet_headers)?void 0:n.length)>0?(c.default.headers||(c.default.headers={}),c.default.headers[l]||(c.default.headers[l]={}),c.default.headers[l][d]||(c.default.headers[l][d]={}),c.default.headers[l][d][h]=e.data.worksheet_headers,e.data.tokenDetails&&(c.tokenDetails=e.data.tokenDetails),o({show:!0,msg:(0,s.__)("Worksheet Headers refreshed","bitform")})):o({show:!0,msg:(0,s.__)("No Worksheet headers found. Try changing the header row number or try again","bitform")}),e.data.tokenDetails&&(c.tokenDetails=e.data.tokenDetails),a((0,r.Z)({},c))}else o({show:!0,msg:(0,s.__)("Worksheet Headers refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))}},u=function(e,t,a,n,i,o){if(e.clientId&&e.clientSecret){i(!0);var l="https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/drive&access_type=offline&prompt=consent&response_type=code&state="+encodeURIComponent(window.location.href)+"/redirect&redirect_uri="+encodeURIComponent(bits.googleRedirectURL)+"&client_id="+e.clientId,d=window.open(l,"googleSheet","width=400,height=609,toolbar=off"),c=setInterval((function(){if(d.closed){clearInterval(c);var a={},l=!1,h=localStorage.getItem("__bitforms_googleSheet");if(h&&(l=!0,a=JSON.parse(h),localStorage.removeItem("__bitforms_googleSheet")),a.code&&!a.error&&a&&l){var f=(0,r.Z)({},e);f.accountServer=a["accounts-server"],m(a,f,t,n,i,o)}else{var u=a.error?"Cause: "+a.error:"";o({show:!0,msg:(0,s.__)("Authorization failed","bitform")+" "+u+". "+(0,s.__)("please try again","bitform")}),i(!1)}}}),500)}else a({clientId:e.clientId?"":(0,s.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,s.__)("Secret key cann't be empty","bitform")})},m=function(e,t,a,i,o,l){var d=(0,r.Z)({},e);d.clientId=t.clientId,d.clientSecret=t.clientSecret,d.redirectURI=bits.googleRedirectURL,(0,n.Z)(d,"bitforms_gsheet_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var n=(0,r.Z)({},t);n.tokenDetails=e.data,a(n),i(!0),l({show:!0,msg:(0,s.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?l({show:!0,msg:""+(0,s.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,s.__)("please try again","bitform")}):l({show:!0,msg:(0,s.__)("Authorization failed. please try again","bitform")});o(!1)}))}}}]);