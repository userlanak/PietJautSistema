(self.webpackChunk_bitforms=self.webpackChunk_bitforms||[]).push([[9293],{9293:function(e,t,a){"use strict";a.d(t,{Rx:function(){return i},Ck:function(){return s},vF:function(){return u},X7:function(){return f},$8:function(){return c},TF:function(){return m},oQ:function(){return _},lF:function(){return h},Pd:function(){return p},P_:function(){return F}});var l=a(2122),r=a(5637),o=a(9492),i=function(e,t,a,r,o,i,s,u,f,c){var m=(0,l.Z)({},a);if(0===t){if(u){var _=(0,l.Z)({},f);_[e.target.name]="",c((0,l.Z)({},_))}m[e.target.name]=e.target.value}else m.relatedlists||(m.relatedlists=[]),m.relatedlists[t-1][e.target.name]=e.target.value;switch(e.target.name){case"module":m=n(t,o,m,r,i,s);break;case"layout":m=d(t,o,m,r,i,s)}r((0,l.Z)({},m))},s=function(e,t,a,l,r,o,i){var s,n;e&&((null==(s=l.default)||null==(n=s.relatedlists)||!n[l.module])&&c(a,l,r,o,i));t(e)},n=function(e,t,a,r,o,i){var s,n=(0,l.Z)({},a),u=0===e?n.module:n.relatedlists[e-1].module;if(n.relatedlists[e-1]||(n.relatedlists[e-1]={}),0===e?(n.layout="",n.actions={},n.field_map=[{formField:"",zohoFormField:""}],n.upload_field_map=[{formField:"",zohoFormField:""}],n.relatedlists=[]):(n.relatedlists[e-1].layout="",n.relatedlists[e-1].actions={},n.relatedlists[e-1].field_map=[{formField:"",zohoFormField:""}],n.relatedlists[e-1].upload_field_map=[{formField:"",zohoFormField:""}]),null!=(s=n.default.layouts)&&s[u]){var c,m=Object.keys(null==(c=n.default.layouts)?void 0:c[u]);1===m.length&&(0===e?n.layout=m[0]:n.relatedlists[e-1].layout=m[0],n=d(e,t,n,r,o,i))}else f(e,t,n,r,o,i);return n},d=function(e,t,a,r,o,i){var s,n,d,u,f,c,_,h,p,F,y,b,k,v,C,D,z,Z=(0,l.Z)({},a),w=0===e?Z.module:Z.relatedlists[e-1].module,I=0===e?Z.layout:Z.relatedlists[e-1].layout;0===e?(Z.actions={},Z.field_map=null!=Z&&null!=(n=Z.default)&&null!=(d=n.layouts)&&null!=(u=d[w])&&null!=(f=u[I])&&f.required?g(e,Z):[{formField:"",zohoFormField:""}],Z.upload_field_map=null!=Z&&null!=(c=Z.default)&&null!=(_=c.layouts)&&null!=(h=_[w])&&null!=(p=h[I])&&p.requiredFileUploadFields&&Object.keys(Z.default.layouts[w][I].requiredFileUploadFields).length>0?g(e,Z,!0):[{formField:"",zohoFormField:""}]):(Z.relatedlists[e-1].actions={},Z.relatedlists[e-1].field_map=null!=Z&&null!=(F=Z.default)&&null!=(y=F.layouts)&&null!=(b=y[w])&&null!=(k=b[I])&&k.required?g(e,Z):[{formField:"",zohoFormField:""}],Z.relatedlists[e-1].upload_field_map=null!=Z&&null!=(v=Z.default)&&null!=(C=v.layouts)&&null!=(D=C[w])&&null!=(z=D[I])&&z.requiredFileUploadFields&&Object.keys(Z.default.layouts[w][I].requiredFileUploadFields).length>0?g(e,Z,!0):[{formField:"",zohoFormField:""}]);return(null==(s=Z.default.tags)||!s[w])&&m(e,t,Z,r,o,i),Z},u=function(e,t,a,i,s){i(!0);var n={formID:e,id:t.id,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,o.Z)(n,"bitforms_zcrm_refresh_modules").then((function(e){if(e&&e.success){var o=(0,l.Z)({},t);o.default||(o.default={}),e.data.modules&&(o.default.modules=e.data.modules),e.data.tokenDetails&&(o.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},o)),s({show:!0,msg:(0,r.__)("Modules refreshed","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?s({show:!0,msg:(0,r.g)((0,r.__)("Modules refresh failed Cause: %s. please try again","bitform"),e.data.data||e.data)}):s({show:!0,msg:(0,r.__)("Modules refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},f=function(e,t,a,i,s,n){var d=(0,l.Z)({},a),u=0===e?d.module:d.relatedlists[e-1].module;if(u){s(!0);var f={formID:t,module:u,dataCenter:d.dataCenter,clientId:d.clientId,clientSecret:d.clientSecret,tokenDetails:d.tokenDetails};(0,o.Z)(f,"bitforms_zcrm_refresh_layouts").then((function(a){var o;if(a&&a.success){if(a.data.layouts){d.default.layouts||(d.default.layouts={}),d.default.layouts[u]=a.data.layouts;var f,c=[].concat(Object.keys(a.data.layouts));if(1===c.length)0===e?(d.layout=c[0],d.field_map=g(e,d),Object.keys(a.data.layouts[c].fileUploadFields).length>0&&(d.upload_field_map=g(e,d,!0))):(d.relatedlists[e-1].layout=c[0],d.relatedlists[e-1].field_map=g(e,d),Object.keys(a.data.layouts[c].fileUploadFields).length>0&&(d.relatedlists[e-1].upload_field_map=g(e,d,!0))),null!=(f=d.default.tags)&&f[u]||m(e,t,d,i,s,n)}a.data.tokenDetails&&(d.tokenDetails=a.data.tokenDetails),i((0,l.Z)({},d)),n({show:!0,msg:(0,r.__)("Layouts refreshed","bitform")})}else null!=a&&null!=(o=a.data)&&o.data||!a.success&&"string"===typeof a.data?n({show:!0,msg:(0,r.g)((0,r.__)("Layouts refresh failed Cause: %s. please try again","bitform"),a.data.data||a.data)}):n({show:!0,msg:(0,r.__)("Layouts refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))}},c=function(e,t,a,i,s){if(t.module){i(!0);var n={formID:e,module:t.module,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,o.Z)(n,"bitforms_zcrm_get_related_lists").then((function(e){var o;if(e&&e.success){var n=(0,l.Z)({},t);e.data.relatedLists&&(n.default.relatedlists||(n.default.relatedlists={}),n.default.relatedlists[n.module]=(0,l.Z)({},e.data.relatedLists)),e.data.tokenDetails&&(n.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},n)),s({show:!0,msg:(0,r.__)("RelatedLists refreshed","bitform")})}else null!=e&&null!=(o=e.data)&&o.data||!e.success&&"string"===typeof e.data?s({show:!0,msg:""+(0,r.__)("RelatedLists refresh failed Cause:")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):s({show:!0,msg:(0,r.__)("RelatedLists refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))}},m=function(e,t,a,i,s,n){var d=0===e?a.module:a.relatedlists[e-1].module;if(d){s(!0);var u={formID:t,module:d,dataCenter:a.dataCenter,clientId:a.clientId,clientSecret:a.clientSecret,tokenDetails:a.tokenDetails};(0,o.Z)(u,"bitforms_zcrm_get_tags").then((function(e){var t;if(null!=e&&e.success){var o=(0,l.Z)({},a);e.data.tags&&(o.default.tags||(o.default.tags={}),o.default.tags[d]=(0,l.Z)({},e.data.tags)),e.data.tokenDetails&&(o.tokenDetails=e.data.tokenDetails),i((0,l.Z)({},o)),n({show:!0,msg:(0,r.__)("Tags refreshed","bitform")})}else null!=e&&null!=(t=e.data)&&t.data||!e.success&&"string"===typeof e.data?n({show:!0,msg:""+(0,r.__)("Tags refresh failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):n({show:!0,msg:(0,r.__)("Tags refresh failed. please try again","bitform")});s(!1)})).catch((function(){return s(!1)}))}},_=function(e,t,a,i,s){i(!0);var n={formID:e,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,o.Z)(n,"bitforms_zcrm_get_users").then((function(e){if(null!=e&&e.success){var o=(0,l.Z)({},t);o.default.crmOwner=e.data.users,e.data.tokenDetails&&(o.tokenDetails=e.data.tokenDetails),a((0,l.Z)({},o)),s({show:!0,msg:(0,r.__)("Owners refreshed","bitform")})}else s({show:!0,msg:(0,r.__)("Owners refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))},h=function(e,t,a,i,s){var n=0===e?t.module:t.relatedlists[e-1].module;if(n){i(!0);var d={module:n,dataCenter:t.dataCenter,clientId:t.clientId,clientSecret:t.clientSecret,tokenDetails:t.tokenDetails};(0,o.Z)(d,"bitforms_zcrm_get_assignment_rules").then((function(e){if(null!=e&&e.success){var o=(0,l.Z)({},t);o.default.assignmentRules||(o.default.assignmentRules={}),e.data.tokenDetails&&(o.tokenDetails=e.data.tokenDetails),o.default.assignmentRules[n]=(0,l.Z)({},e.data.assignmentRules),a((0,l.Z)({},o)),s({show:!0,msg:(0,r.__)("Assignment Rules refreshed","bitform")})}else s({show:!0,msg:(0,r.__)("Assignment Rules refresh failed. please try again","bitform")});i(!1)})).catch((function(){return i(!1)}))}},g=function(e,t,a){var l=0===e?t.module:t.relatedlists[e-1].module,r=0===e?t.layout:t.relatedlists[e-1].layout;return a?t.default.layouts[l][r].requiredFileUploadFields.length>0?t.default.layouts[l][r].requiredFileUploadFields.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]:t.default.layouts[l][r].required.length>0?t.default.layouts[l][r].required.map((function(e){return{formField:"",zohoFormField:e}})):[{formField:"",zohoFormField:""}]},p=function(e){var t=null!=e&&e.field_map?e.field_map.filter((function(t){var a,l,r,o;return!t.formField&&t.zohoFormField&&-1!==(null==e||null==(a=e.default)||null==(l=a.layouts)||null==(r=l[e.module])||null==(o=r[e.layout])?void 0:o.required.indexOf(t.zohoFormField))})):[],a=null!=e&&e.upload_field_map?e.upload_field_map.filter((function(t){return!t.formField&&t.zohoFormField&&-1!==e.default.layouts[e.module][e.layout].requiredFileUploadFields.indexOf(t.zohoFormField)})):[],l=e.relatedlists.map((function(e){return e.field_map.filter((function(e){return!e.formField&&e.zohoFormField}))})),r=e.relatedlists.map((function(e){return e.upload_field_map.filter((function(e){return!e.formField&&e.zohoFormField}))}));return!(t.length>0||a.length>0||l.some((function(e){return e.length}))||r.some((function(e){return e.length})))},F=function(e,t,a,o,i,s){if(e.dataCenter&&e.clientId&&e.clientSecret){i(!0);var n="https://accounts.zoho."+e.dataCenter+"/oauth/v2/auth?scope=ZohoCRM.modules.ALL,ZohoCRM.settings.ALL,ZohoCRM.users.Read,zohocrm.files.CREATE&response_type=code&client_id="+e.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(window.location.href)+"/redirect",d=window.open(n,"zohoCRM","width=400,height=609,toolbar=off"),u=setInterval((function(){if(d.closed){clearInterval(u);var a={},n=!1,f=localStorage.getItem("__bitforms_zohoCRM");if(f&&(n=!0,a=JSON.parse(f),localStorage.removeItem("__bitforms_zohoCRM")),a.code&&!a.error&&a&&n){var c=(0,l.Z)({},e);c.accountServer=a["accounts-server"],y(a,c,t,o,i,s)}else{var m=a.error?"Cause: "+a.error:"";s({show:!0,msg:(0,r.__)("Authorization failed","bitform")+" "+m+". "+(0,r.__)("please try again","bitform")}),i(!1)}}}),500)}else a({dataCenter:e.dataCenter?"":(0,r.__)("Data center cann't be empty","bitform"),clientId:e.clientId?"":(0,r.__)("Client ID cann't be empty","bitform"),clientSecret:e.clientSecret?"":(0,r.__)("Secret key cann't be empty","bitform")})},y=function(e,t,a,i,s,n){var d=(0,l.Z)({},e);d.dataCenter=t.dataCenter,d.clientId=t.clientId,d.clientSecret=t.clientSecret,d.redirectURI=encodeURIComponent(window.location.href)+"/redirect",(0,o.Z)(d,"bitforms_zcrm_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var o=(0,l.Z)({},t);o.tokenDetails=e.data,a(o),i(!0),n({show:!0,msg:(0,r.__)("Authorized Successfully","bitform")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?n({show:!0,msg:""+(0,r.__)("Authorization failed Cause:","bitform")+(e.data.data||e.data)+". "+(0,r.__)("please try again","bitform")}):n({show:!0,msg:(0,r.__)("Authorization failed. please try again","bitform")});s(!1)}))}}}]);